"use strict";(self.webpackChunkleix_wang_website=self.webpackChunkleix_wang_website||[]).push([[78],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=r.createContext({}),s=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return r.createElement(i.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),g=s(t),m=l,k=g["".concat(i,".").concat(m)]||g[m]||u[m]||a;return t?r.createElement(k,o(o({ref:n},c),{},{components:t})):r.createElement(k,o({ref:n},c))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=g;var p={};for(var i in n)hasOwnProperty.call(n,i)&&(p[i]=n[i]);p.originalType=e,p.mdxType="string"==typeof e?e:l,o[1]=p;for(var s=2;s<a;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},4517:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return p},contentTitle:function(){return i},metadata:function(){return s},toc:function(){return c},default:function(){return g}});var r=t(7462),l=t(3366),a=(t(7294),t(3905)),o=["components"],p={sidebar_position:5},i="\u5fae\u670d\u52a1\uff08micro services\uff09",s={unversionedId:"golang/micro-server",id:"golang/micro-server",title:"\u5fae\u670d\u52a1\uff08micro services\uff09",description:"1563802988667",source:"@site/docs/01.golang/05.micro-server.md",sourceDirName:"01.golang",slug:"/golang/micro-server",permalink:"/docs/golang/micro-server",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Session\u529f\u80fd\u5b9e\u73b0",permalink:"/docs/golang/session"},next:{title:"\u79df\u623f\u7f51",permalink:"/docs/golang/home"}},c=[{value:"1.1 \u4ec0\u4e48\u662f\u5fae\u670d\u52a1\uff1f",id:"11-\u4ec0\u4e48\u662f\u5fae\u670d\u52a1",children:[],level:2},{value:"1.2 \u5fae\u670d\u52a1\u8fd9\u4e2a\u6982\u5ff5\u7684\u7531\u6765",id:"12-\u5fae\u670d\u52a1\u8fd9\u4e2a\u6982\u5ff5\u7684\u7531\u6765",children:[],level:2},{value:"1.3 \u5fae\u670d\u52a1\u548c\u5355\u4f53\u5f0f\u67b6\u6784\u533a\u522b",id:"13-\u5fae\u670d\u52a1\u548c\u5355\u4f53\u5f0f\u67b6\u6784\u533a\u522b",children:[],level:2},{value:"2.1 RPC\u7684\u6982\u5ff5",id:"21-rpc\u7684\u6982\u5ff5",children:[],level:2},{value:"2.2 \u4e3a\u4ec0\u4e48\u5fae\u670d\u52a1\u9700\u8981RPC",id:"22-\u4e3a\u4ec0\u4e48\u5fae\u670d\u52a1\u9700\u8981rpc",children:[],level:2},{value:"2.3 RPC\u5165\u95e8",id:"23-rpc\u5165\u95e8",children:[{value:"2.3.1 RPC\u7248\u7684&quot;hello world&quot;",id:"231-rpc\u7248\u7684hello-world",children:[],level:3},{value:"2.3.2 \u8de8\u8bed\u8a00\u7684RPC",id:"232-\u8de8\u8bed\u8a00\u7684rpc",children:[],level:3},{value:"2.3.4 RPC\u534f\u8bae\u5c01\u88c5",id:"234-rpc\u534f\u8bae\u5c01\u88c5",children:[{value:"\u670d\u52a1\u7aef\u5c01\u88c5",id:"\u670d\u52a1\u7aef\u5c01\u88c5",children:[],level:5},{value:"\u5ba2\u6237\u7aef\u5c01\u88c5",id:"\u5ba2\u6237\u7aef\u5c01\u88c5",children:[],level:5}],level:3}],level:2},{value:"3.1 protobuf\u7b80\u4ecb",id:"31-protobuf\u7b80\u4ecb",children:[],level:2},{value:"3.2 protobuf\u7684\u5b89\u88c5",id:"32-protobuf\u7684\u5b89\u88c5",children:[],level:2},{value:"3.3 protobuf \u7b80\u5355\u8bed\u6cd5",id:"33-protobuf-\u7b80\u5355\u8bed\u6cd5",children:[{value:"3.3.1protobuf\u9ad8\u7ea7\u7528\u6cd5",id:"331protobuf\u9ad8\u7ea7\u7528\u6cd5",children:[],level:3}],level:2},{value:"3.4 protobuf\u57fa\u672c\u7f16\u8bd1",id:"34-protobuf\u57fa\u672c\u7f16\u8bd1",children:[],level:2},{value:"4.1 grpc\u73af\u5883\u5b89\u88c5",id:"41-grpc\u73af\u5883\u5b89\u88c5",children:[],level:2},{value:"4.2 GRPC\u4f7f\u7528",id:"42-grpc\u4f7f\u7528",children:[],level:2},{value:"5.1 \u670d\u52a1\u53d1\u73b0",id:"51-\u670d\u52a1\u53d1\u73b0",children:[],level:2},{value:"5.2 \u4e86\u89e3consul\u5e76\u4f7f\u7528",id:"52-\u4e86\u89e3consul\u5e76\u4f7f\u7528",children:[{value:"5.2.1 consul\u5b89\u88c5",id:"521-consul\u5b89\u88c5",children:[],level:3},{value:"5.2.2 consul\u7684\u547d\u4ee4\u884c",id:"522-consul\u7684\u547d\u4ee4\u884c",children:[],level:3},{value:"5.2.3 consul\u7b80\u5355\u4f7f\u7528",id:"523-consul\u7b80\u5355\u4f7f\u7528",children:[{value:"server\u6a21\u5f0f\u542f\u52a8",id:"server\u6a21\u5f0f\u542f\u52a8",children:[],level:4},{value:"<strong>client\u6a21\u5f0f\u542f\u52a8</strong>",id:"client\u6a21\u5f0f\u542f\u52a8",children:[],level:4},{value:"<strong>\u67e5\u770bconsul\u6210\u5458</strong>",id:"\u67e5\u770bconsul\u6210\u5458",children:[],level:4},{value:"<strong>\u505c\u6b62agent</strong>",id:"\u505c\u6b62agent",children:[],level:4},{value:"<strong>\u6ce8\u518c\u670d\u52a1</strong>",id:"\u6ce8\u518c\u670d\u52a1",children:[],level:4},{value:"<strong>\u67e5\u8be2\u670d\u52a1</strong>",id:"\u67e5\u8be2\u670d\u52a1",children:[],level:4},{value:"<strong>\u5065\u5eb7\u68c0\u67e5</strong>",id:"\u5065\u5eb7\u68c0\u67e5",children:[],level:4}],level:3},{value:"5.2.4 consul\u548cgrpc\u7ed3\u5408\u4f7f\u7528",id:"524-consul\u548cgrpc\u7ed3\u5408\u4f7f\u7528",children:[{value:"<strong>\u628agrpc\u670d\u52a1\u6ce8\u518c\u5230consul\u4e0a</strong>",id:"\u628agrpc\u670d\u52a1\u6ce8\u518c\u5230consul\u4e0a",children:[],level:4},{value:"<strong>\u670d\u52a1\u53d1\u73b0</strong>",id:"\u670d\u52a1\u53d1\u73b0",children:[],level:4},{value:"<strong>\u6ce8\u9500\u670d\u52a1</strong>",id:"\u6ce8\u9500\u670d\u52a1",children:[],level:4}],level:3}],level:2},{value:"5.3 go-micro\u5b89\u88c5",id:"53-go-micro\u5b89\u88c5",children:[],level:2},{value:"5.4 go-micro\u4f7f\u7528",id:"54-go-micro\u4f7f\u7528",children:[],level:2}],u={toc:c};function g(e){var n=e.components,p=(0,l.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},u,p,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u5fae\u670d\u52a1micro-services"},"\u5fae\u670d\u52a1\uff08micro services\uff09"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1563802988667",src:t(448).Z})),(0,a.kt)("p",null,"\u200b\t\u8fd1\u51e0\u5e74,\u5fae\u670d\u8fd9\u4e2a\u8bcd\u95ef\u5165\u4e86\u6211\u4eec\u7684\u89c6\u7ebf\u8303\u56f4\u3002\u5728\u767e\u5ea6\u4e0e\u8c37\u6b4c\u4e2d\u968f\u4fbf\u641c\u4e00\u641c\u4e5f\u6709\u51e0\u5343\u4e07\u6761\u7684\u7ed3\u679c\u3002\u90a3\u4e48\uff0c\u4ec0\u4e48\u662f\u5fae\u670d\u52a1\u5462\uff1f\u5fae\u670d\u52a1\u7684\u6982\u5ff5\u662f\u600e\u4e48\u4ea7\u751f\u7684\u5462\uff1f\n\u200b\t\u6211\u4eec\u9996\u5148\u6765\u4e86\u89e3\u4e00\u4e0bGo\u8bed\u8a00\u4e0e\u5fae\u670d\u52a1\u7684\u5343\u4e1d\u4e07\u7f15\u4e0e\u6765\u9f99\u53bb\u8109\u3002"),(0,a.kt)("h2",{id:"11-\u4ec0\u4e48\u662f\u5fae\u670d\u52a1"},"1.1 \u4ec0\u4e48\u662f\u5fae\u670d\u52a1\uff1f"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u670d\u52a1\u62c6\u5206\u539f\u5219\uff1a\u9ad8\u5185\u805a\u4f4e\u8026\u5408")),(0,a.kt)("p",null,'\u200b       \u5728\u4ecb\u7ecd\u5fae\u670d\u52a1\u65f6\uff0c\u9996\u5148\u5f97\u5148\u7406\u89e3\u4ec0\u4e48\u662f\u5fae\u670d\u52a1\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5fae\u670d\u52a1\u5f97\u4ece\u4e24\u4e2a\u65b9\u9762\u53bb\u7406\u89e3\uff0c\u4ec0\u4e48\u662f"\u5fae"\u3001\u4ec0\u4e48\u662f"\u670d\u52a1"\uff1f'),(0,a.kt)("p",null,'\u200b       \u5fae\uff08micro\uff09\u72ed\u4e49\u6765\u8bb2\u5c31\u662f\u4f53\u79ef\u5c0f\uff0c\u8457\u540d\u7684"2 pizza \u56e2\u961f"\u5f88\u597d\u7684\u8be0\u91ca\u4e86\u8fd9\u4e00\u89e3\u91ca\uff082 pizza \u56e2\u961f\u6700\u65e9\u662f\u4e9a\u9a6c\u900a CEO Bezos\u63d0\u51fa\u6765\u7684\uff0c\u610f\u601d\u662f\u8bf4\u5355\u4e2a\u670d\u52a1\u7684\u8bbe\u8ba1\uff0c\u6240\u6709\u53c2\u4e0e\u4eba\u4ece\u8bbe\u8ba1\u3001\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u8fd0\u7ef4\u6240\u6709\u4eba\u52a0\u8d77\u6765 \u53ea\u9700\u89812\u4e2a\u62ab\u8428\u5c31\u591f\u4e86 \uff09\u3002 '),(0,a.kt)("p",null,"\u200b       \u670d\u52a1\uff08service\uff09\u4e00\u5b9a\u8981\u533a\u522b\u4e8e\u7cfb\u7edf\uff0c\u670d\u52a1\u4e00\u4e2a\u6216\u8005\u4e00\u7ec4\u76f8\u5bf9\u8f83\u5c0f\u4e14\u72ec\u7acb\u7684\u529f\u80fd\u5355\u5143\uff0c\u662f\u7528\u6237\u53ef\u4ee5\u611f\u77e5\u6700\u5c0f\u529f\u80fd\u96c6\u3002"),(0,a.kt)("p",null," \u90a3\u4e48\u5e7f\u4e49\u4e0a\u6765\u8bb2\uff0c\u5fae\u670d\u52a1\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\uff0c\u63a8\u52a8\u7ec6\u7c92\u5ea6\u670d\u52a1\u7684\u4f7f\u7528\uff0c\u8fd9\u4e9b\u670d\u52a1\u534f\u540c\u5de5\u4f5c\u3002"),(0,a.kt)("h2",{id:"12-\u5fae\u670d\u52a1\u8fd9\u4e2a\u6982\u5ff5\u7684\u7531\u6765"},"1.2 \u5fae\u670d\u52a1\u8fd9\u4e2a\u6982\u5ff5\u7684\u7531\u6765"),(0,a.kt)("p",null,"\u200b       \u636e\u8bf4\uff0c\u65e9\u572819xx,\u975eIT\u884c\u4e1a\u63d0\u51fa\u7684\u6982\u5ff5\uff0c\u5728\u5a01\u5c3c\u65af\u9644\u8fd1\u7684\u8f6f\u4ef6\u67b6\u6784\u5e08\u8ba8\u8bba\u4f1a\u4e0a\uff0c\u5c31\u6709\u4eba\u63d0\u51fa\u4e86\u5fae\u670d\u52a1\u67b6\u6784\u8bbe\u8ba1\u7684\u6982\u5ff5\uff0c\u7528\u5b83\u6765\u63cf\u8ff0\u4e0e\u4f1a\u8005\u6240\u89c1\u7684\u4e00\u79cd\u901a\u7528\u7684\u67b6\u6784\u8bbe\u8ba1\u98ce\u683c\u3002\u65f6\u9694\u4e00\u5e74\u4e4b\u540e\uff0c\u5728\u540c\u4e00\u4e2a\u8ba8\u8bba\u4f1a\u4e0a\uff0c\u5927\u5bb6\u51b3\u5b9a\u5c06\u8fd9\u79cd\u67b6\u6784\u8bbe\u8ba1\u98ce\u683c\u7528\u5fae\u670d\u52a1\u67b6\u6784\u6765\u8868\u793a\u3002"),(0,a.kt)("p",null,"\u200b       \u8d77\u521d\uff0c\u5bf9\u5fae\u670d\u52a1\u7684\u6982\u5ff5\uff0c\u6ca1\u6709\u4e00\u4e2a\u660e\u786e\u7684\u5b9a\u4e49\uff0c\u5927\u5bb6\u53ea\u80fd\u4ece\u5404\u81ea\u7684\u89d2\u5ea6\u8bf4\u51fa\u4e86\u5fae\u670d\u52a1\u7684\u7406\u89e3\u548c\u770b\u6cd5\u3002"),(0,a.kt)("p",null,"\u200b       \u57282014\u5e743\u6708\uff0c\u8a79\u59c6\u65af\xb7\u5218\u6613\u65af\uff08James Lewis\uff09\u4e0e\u9a6c\u4e01\xb7\u798f\u52d2\uff08Martin Fowler\uff09\u6240\u53d1\u8868\u7684\u4e00\u7bc7\u535a\u5ba2\u4e2d\uff0c\u603b\u7ed3\u4e86\u5fae\u670d\u52a1\u67b6\u6784\u8bbe\u8ba1\u7684\u4e00\u4e9b\u5171\u540c\u7279\u70b9\uff0c\u8fd9\u5e94\u8be5\u662f\u4e00\u4e2a\u5bf9\u5fae\u670d\u52a1\u6bd4\u8f83\u5168\u9762\u7684\u63cf\u8ff0\u3002"),(0,a.kt)("p",null,"\u200b       \u539f\u6587\u94fe\u63a5       ",(0,a.kt)("a",{parentName:"p",href:"https://martinfowler.com/articles/microservices.html"},"https://martinfowler.com/articles/microservices.html"),"   "),(0,a.kt)("p",null,"\u200b       \u8fd9\u7bc7\u6587\u7ae0\u4e2d\u8ba4\u4e3a\uff1a",(0,a.kt)("strong",{parentName:"p"},"\u201c\u7b80\u800c\u8a00\u4e4b\uff0c\u5fae\u670d\u52a1\u67b6\u6784\u98ce\u683c\u662f\u5c06\u5355\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4f5c\u4e3a\u4e00\u7ec4\u5c0f\u578b\u670d\u52a1\u5f00\u53d1\u7684\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u670d\u52a1\u7a0b\u5e8f\u90fd\u5728\u81ea\u5df1\u7684\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e0e\u8f7b\u91cf\u7ea7\u673a\u5236\uff08\u901a\u5e38\u662fHTTP\u8d44\u6e90API\uff09\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u4e9b\u670d\u52a1\u662f\u56f4\u7ed5\u4e1a\u52a1\u529f\u80fd\u6784\u5efa\u7684\u3002\u53ef\u4ee5\u901a\u8fc7\u5168\u81ea\u52a8\u90e8\u7f72\u673a\u5668\u72ec\u7acb\u90e8\u7f72\u3002\u8fd9\u4e9b\u670d\u52a1\u5668\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u7f16\u5199\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u6570\u636e\u5b58\u50a8\u6280\u672f\uff0c\u5e76\u5c3d\u91cf\u4e0d\u7528\u96c6\u4e2d\u5f0f\u65b9\u5f0f\u8fdb\u884c\u7ba1\u7406\u201d")),(0,a.kt)("p",null,"\u200b    \u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u80fd\u4f1a\u6df7\u6dc6\u4e00\u4e2a\u70b9\uff0c\u90a3\u5c31\u662f\u5fae\u670d\u52a1\u548c\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u8fd9\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u6982\u5ff5\uff0c\u800c\u6211\u4eec\u5e73\u65f6\u8bf4\u5230\u7684\u5fae\u670d\u52a1\u5df2\u7ecf\u5305\u542b\u4e86\u8fd9\u4e24\u4e2a\u6982\u5ff5\u4e86\uff0c\u6211\u4eec\u9700\u8981\u628a\u5b83\u4eec\u8bf4\u6e05\u695a\u4ee5\u514d\u5b66\u4e60\u4e2d\u7ea0\u7ed3\u3002\u5fae\u670d\u52a1\u67b6\u6784\u662f\u4e00\u79cd\u8bbe\u8ba1\u65b9\u6cd5\uff0c\u800c\u5fae\u670d\u52a1\u8fd9\u662f\u6307\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u800c\u8bbe\u8ba1\u7684\u4e00\u4e2a\u5e94\u7528\u3002\u6240\u4ee5\u6211\u4eec\u5fc5\u8981\u5bf9\u5fae\u670d\u52a1\u7684\u6982\u5ff5\u505a\u51fa\u4e00\u4e2a\u6bd4\u8f83\u660e\u786e\u7684\u5b9a\u4e49\u3002"),(0,a.kt)("p",null,"\u200b       ",(0,a.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1\u67b6\u6784"),"\u662f\u5c06\u590d\u6742\u7684\u7cfb\u7edf\u4f7f\u7528\u7ec4\u4ef6\u5316\u7684\u65b9\u5f0f\u8fdb\u884c\u62c6\u5206\uff0c\u5e76\u4f7f\u7528\u8f7b\u91cf\u7ea7\u901a\u8baf\u65b9\u5f0f\u8fdb\u884c\u6574\u5408\u7684\u4e00\u79cd\u8bbe\u8ba1\u65b9\u6cd5\u3002"),(0,a.kt)("p",null,"\u200b       ",(0,a.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1"),"\u662f\u901a\u8fc7\u8fd9\u79cd\u67b6\u6784\u8bbe\u8ba1\u65b9\u6cd5\u62c6\u5206\u51fa\u6765\u7684\u4e00\u4e2a\u72ec\u7acb\u7684\u7ec4\u4ef6\u5316\u7684\u5c0f\u5e94\u7528\u3002"),(0,a.kt)("p",null,"\u200b       \u5fae\u670d\u52a1\u67b6\u6784\u5b9a\u4e49\u7684\u7cbe\u9ad3\uff0c\u53ef\u4ee5\u7528\u4e00\u53e5\u8bdd\u6765\u63cf\u8ff0\uff0c\u90a3\u5c31\u662f\u201c",(0,a.kt)("strong",{parentName:"p"},"\u5206\u800c\u6cbb\u4e4b\uff0c\u5408\u800c\u7528\u4e4b"),"\u201d\u3002\u5c06\u590d\u6742\u7684\u7cfb\u7edf\u8fdb\u884c\u62c6\u5206\u7684\u65b9\u6cd5\uff0c\u5c31\u662f\u201c\u5206\u800c\u6cbb\u4e4b\u201d\u3002\u5206\u800c\u6cbb\u4e4b\uff0c\u53ef\u4ee5\u8ba9\u590d\u6742\u7684\u4e8b\u60c5\u53d8\u7684\u7b80\u5355\uff0c\u8fd9\u5f88\u7b26\u5408\u6211\u4eec\u5e73\u65f6\u5904\u7406\u95ee\u9898\u7684\u65b9\u6cd5\u3002 \u4f7f\u7528\u8f7b\u91cf\u7ea7\u901a\u8baf\u7b49\u65b9\u5f0f\u8fdb\u884c\u6574\u5408\u7684\u8bbe\u8ba1\uff0c\u5c31\u662f\u201c\u5408\u800c\u7528\u4e4b\u201d\u7684\u65b9\u6cd5\uff0c\u5408\u800c\u7528\u4e4b\u53ef\u4ee5\u8ba9\u5fae\u5c0f\u7684\u529b\u91cf\u53d8\u52a8\u5f3a\u5927\u3002"),(0,a.kt)("h2",{id:"13-\u5fae\u670d\u52a1\u548c\u5355\u4f53\u5f0f\u67b6\u6784\u533a\u522b"},"1.3 \u5fae\u670d\u52a1\u548c\u5355\u4f53\u5f0f\u67b6\u6784\u533a\u522b"),(0,a.kt)("p",null,"\u200b\t\t\u548c\u5fae\u670d\u52a1\u67b6\u6784\u76f8\u53cd\u7684\u5c31\u662f\u5355\u4f53\u5f0f\u67b6\u6784\uff0c\u6211\u4eec\u6765\u770b\u770b\u5355\u4f53\u5f0f\u67b6\u6784\u8bbe\u8ba1\u7684\u7f3a\u70b9\uff0c\u5c31\u66f4\u80fd\u4f53\u4f1a\u5fae\u670d\u52a1\u7684\u597d\u5904\u4e86\u3002\u5355\u4f53\u67b6\u6784\u5728\u89c4\u6a21\u6bd4\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u5de5\u4f5c\u60c5\u51b5\u826f\u597d\uff0c\u4f46\u662f\u968f\u7740\u7cfb\u7edf\u89c4\u6a21\u7684\u6269\u5927\uff0c\u5b83\u66b4\u9732\u51fa\u6765\u7684\u95ee\u9898\u4e5f\u8d8a\u6765\u8d8a\u591a\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u590d\u6742\u6027\u9010\u6e10\u53d8\u9ad8")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4e2d\u8f6f\u56fd\u9645   boss\u8ba1\u8d39\u7cfb\u7edf   \u5341\u51e0\u5e74\u4e86     \u79fb\u52a8\u8054\u901a\u7f34\u8d39\u5e73\u53f0   \u51e0\u4e2a\u4ebf"),(0,a.kt)("p",{parentName:"blockquote"},"\u81ea\u5df1\u5c01\u88c5\u51fd\u6570    \u4ee3\u7801\u5197\u4f59\u5ea6\u7279\u522b\u5927")),(0,a.kt)("p",null,"\u6bd4\u5982\u6709\u51e0\u5341\u4e07\u884c\u4ee3\u7801\u7684\u5927\u9879\u76ee\uff0c\u4ee3\u7801\u8d8a\u591a\u590d\u6742\u6027\u8d8a\u9ad8\uff0c\u8d8a\u96be\u89e3\u51b3\u9047\u5230\u7684\u95ee\u9898\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6280\u672f\u503a\u52a1\u9010\u6e10\u4e0a\u5347")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u79bb\u804c\u8bc1\u660e  \u7559\u4e0b\u4e8664\u4e2abug\u672a\u89e3\u51b3\u5c31\u79bb\u804c\u4e86")),(0,a.kt)("p",null,"\u200b\t\t\u516c\u53f8\u7684\u4eba\u5458\u6d41\u52a8\u662f\u518d\u6b63\u5e38\u4e0d\u8fc7\u7684\u4e8b\u60c5\uff0c\u6709\u7684\u5458\u5de5\u5728\u79bb\u804c\u4e4b\u524d\uff0c\u758f\u4e8e\u4ee3\u7801\u8d28\u91cf\u7684\u81ea\u6211\u7ba1\u675f\uff0c\u5bfc\u81f4\u7559\u4e0b\u6765\u5f88\u591a\u5751\uff0c\u7531\u4e8e\u5355\u4f53\u9879\u76ee\u4ee3\u7801\u91cf\u5e9e\u5927\u7684\u60ca\u4eba\uff0c\u7559\u4e0b\u7684\u5751\u5f88\u96be\u88ab\u53d1\u89c9\uff0c\u8fd9\u5c31\u7ed9\u65b0\u6765\u7684\u5458\u5de5\u5e26\u6765\u5f88\u5927\u7684\u70e6\u607c\uff0c\u4eba\u5458\u6d41\u52a8\u8d8a\u5927\u6240\u7559\u4e0b\u7684\u5751\u8d8a\u591a\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u6280\u672f\u503a\u52a1\u8d8a\u6765\u8d8a\u591a\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8026\u5408\u5ea6\u592a\u9ad8\uff0c\u7ef4\u62a4\u6210\u672c\u5927")),(0,a.kt)("p",null,"\u200b\t\t\u5f53\u5e94\u7528\u7a0b\u5e8f\u7684\u529f\u80fd\u8d8a\u6765\u8d8a\u591a\u3001\u56e2\u961f\u8d8a\u6765\u8d8a\u5927\u65f6\uff0c\u6c9f\u901a\u6210\u672c\u3001\u7ba1\u7406\u6210\u672c\u663e\u8457\u589e\u52a0\u3002\u5f53\u51fa\u73b0 bug \u65f6\uff0c\u53ef\u80fd\u5f15\u8d77 bug \u7684\u539f\u56e0\u7ec4\u5408\u8d8a\u6765\u8d8a\u591a\uff0c\u5bfc\u81f4\u5206\u6790\u3001\u5b9a\u4f4d\u548c\u4fee\u590d\u7684\u6210\u672c\u589e\u52a0\uff1b\u5e76\u4e14\u5728\u5bf9\u5168\u5c40\u529f\u80fd\u7f3a\u4e4f\u6df1\u5ea6\u7406\u89e3\u7684\u60c5\u51b5\u4e0b\uff0c\u5bb9\u6613\u5728\u4fee\u590d bug \u65f6\u5f15\u5165\u65b0\u7684 bug\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6301\u7eed\u4ea4\u4ed8\u5468\u671f\u957f")),(0,a.kt)("p",null,"\u200b       \u6784\u5efa\u548c\u90e8\u7f72\u65f6\u95f4\u4f1a\u968f\u7740\u529f\u80fd\u7684\u589e\u591a\u800c\u589e\u52a0\uff0c\u4efb\u4f55\u7ec6\u5fae\u7684\u4fee\u6539\u90fd\u4f1a\u89e6\u53d1\u90e8\u7f72\u6d41\u6c34\u7ebf\u3002\u65b0\u4eba\u57f9\u517b\u5468\u671f\u957f\uff1a\u65b0\u6210\u5458\u4e86\u89e3\u80cc\u666f\u3001\u719f\u6089\u4e1a\u52a1\u548c\u914d\u7f6e\u73af\u5883\u7684\u65f6\u95f4\u8d8a\u6765\u8d8a\u957f\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6280\u672f\u9009\u578b\u6210\u672c\u9ad8")),(0,a.kt)("p",null,"\u200b\t\t\u5355\u5757\u67b6\u6784\u503e\u5411\u4e8e\u91c7\u7528\u7edf\u4e00\u7684\u6280\u672f\u5e73\u53f0\u6216\u65b9\u6848\u6765\u89e3\u51b3\u6240\u6709\u95ee\u9898\uff0c\u5982\u679c\u540e\u7eed\u60f3\u5f15\u5165\u65b0\u7684\u6280\u672f\u6216\u6846\u67b6\uff0c\u6210\u672c\u548c\u98ce\u9669\u90fd\u5f88\u5927\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u53ef\u6269\u5c55\u6027\u5dee")),(0,a.kt)("p",null,"\u200b\t\t \u968f\u7740\u529f\u80fd\u7684\u589e\u52a0\uff0c\u5782\u76f4\u6269\u5c55\u7684\u6210\u672c\u5c06\u4f1a\u8d8a\u6765\u8d8a\u5927\uff1b\u800c\u5bf9\u4e8e\u6c34\u5e73\u6269\u5c55\u800c\u8a00\uff0c\u56e0\u4e3a\u6240\u6709\u4ee3\u7801\u90fd\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u6ca1\u529e\u6cd5\u505a\u5230\u9488\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u90e8\u5206\u529f\u80fd\u505a\u72ec\u7acb\u7684\u6269\u5c55\u3002"),(0,a.kt)("p",null,"\u4e86\u89e3\u4e86\u5355\u4f53\u5f0f\u7ed3\u6784\u7684\u7f3a\u70b9\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u770b\u770b",(0,a.kt)("strong",{parentName:"p"},"\u5fae\u670d\u52a1\u67b6\u6784\u7684\u89e3\u51b3\u65b9\u6848\uff1a")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u5355\u4e00\u804c\u8d23")),(0,a.kt)("p",{parentName:"li"},"\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\uff0c\u90fd\u662f\u5177\u6709\u4e1a\u52a1\u903b\u8f91\u7684\uff0c\u7b26\u5408\u9ad8\u5185\u805a\u3001\u4f4e\u8026\u5408\u539f\u5219\u4ee5\u53ca\u5355\u4e00\u804c\u8d23\u539f\u5219\u7684\u5355\u5143\uff0c\u4e0d\u540c\u7684\u670d\u52a1\u901a\u8fc7\u201c\u7ba1\u9053\u201d\u7684\u65b9\u5f0f\u7075\u6d3b\u7ec4\u5408\uff0c\u4ece\u800c\u6784\u5efa\u51fa\u5e9e\u5927\u7684\u7cfb\u7edf\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u8f7b\u91cf\u7ea7\u901a\u4fe1")),(0,a.kt)("p",{parentName:"li"},"  \u670d\u52a1\u4e4b\u95f4\u901a\u8fc7\u8f7b\u91cf\u7ea7\u7684\u901a\u4fe1\u673a\u5236\u5b9e\u73b0\u4e92\u901a\u4e92\u8054\uff0c\u800c\u6240\u8c13\u7684\u8f7b\u91cf\u7ea7\uff0c\u901a\u5e38\u6307\u8bed\u8a00\u65e0\u5173\u3001\u5e73\u53f0\u65e0\u5173\u7684\u4ea4\u4e92\u65b9\u5f0f\u3002"),(0,a.kt)("p",{parentName:"li"}," ",(0,a.kt)("img",{alt:"1564056754698",src:t(4447).Z})),(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e\u8f7b\u91cf\u7ea7\u901a\u4fe1\u7684\u683c\u5f0f\u800c\u8a00\uff0c\u6211\u4eec\u719f\u6089\u7684 XML \u548c JSON\uff0c\u5b83\u4eec\u662f\u8bed\u8a00\u65e0\u5173\u3001\u5e73\u53f0\u65e0\u5173\u7684\uff1b\u5bf9\u4e8e\u901a\u4fe1\u7684\u534f\u8bae\u800c\u8a00\uff0c\u901a\u5e38\u57fa\u4e8e HTTP\uff0c\u80fd\u8ba9\u670d\u52a1\u95f4\u7684\u901a\u4fe1\u53d8\u5f97\u6807\u51c6\u5316\u3001\u65e0\u72b6\u6001\u5316\u3002\u4f7f\u7528\u8f7b\u91cf\u7ea7\u901a\u4fe1\u673a\u5236\uff0c\u53ef\u4ee5\u8ba9\u56e2\u961f\u9009\u62e9\u66f4\u9002\u5408\u7684\u8bed\u8a00\u3001\u5de5\u5177\u6216\u8005\u5e73\u53f0\u6765\u5f00\u53d1\u670d\u52a1\u672c\u8eab\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u72ec\u7acb\u6027")),(0,a.kt)("p",{parentName:"li"},"\u6bcf\u4e2a\u670d\u52a1\u5728\u5e94\u7528\u4ea4\u4ed8\u8fc7\u7a0b\u4e2d\uff0c\u72ec\u7acb\u5730\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002"),(0,a.kt)("p",{parentName:"li"},"\u5728\u5355\u4f53\u5f0f\u67b6\u6784\u4e2d\u6240\u6709\u529f\u80fd\u90fd\u5728\u540c\u4e00\u4e2a\u4ee3\u7801\u5e93\uff0c\u529f\u80fd\u7684\u5f00\u53d1\u4e0d\u5177\u6709\u72ec\u7acb\u6027\uff1b\u5f53\u4e0d\u540c\u5c0f\u7ec4\u5b8c\u6210\u591a\u4e2a\u529f\u80fd\u540e\uff0c\u9700\u8981\u7ecf\u8fc7\u96c6\u6210\u548c\u56de\u5f52\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u8fc7\u7a0b\u4e5f\u4e0d\u5177\u6709\u72ec\u7acb\u6027\uff1b\u5f53\u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u5e94\u7528\u88ab\u6784\u5efa\u6210\u4e00\u4e2a\u5305\uff0c\u5982\u679c\u67d0\u4e2a\u529f\u80fd\u5b58\u5728 bug\uff0c\u5c06\u5bfc\u81f4\u6574\u4e2a\u90e8\u7f72\u5931\u8d25\u6216\u8005\u56de\u6eda\u3002"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{alt:"1564058423216",src:t(2773).Z})),(0,a.kt)("p",{parentName:"li"}," \u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\uff0c\u6bcf\u4e2a\u670d\u52a1\u90fd\u662f\u72ec\u7acb\u7684\u4e1a\u52a1\u5355\u5143\uff0c\u4e0e\u5176\u4ed6\u670d\u52a1\u9ad8\u5ea6\u89e3\u8026\uff0c\u53ea\u9700\u8981\u6539\u53d8\u5f53\u524d\u670d\u52a1\u672c\u8eab\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u72ec\u7acb\u7684\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("img",{alt:"1564061722380",src:t(9717).Z})))),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u8fdb\u7a0b\u9694\u79bb")),(0,a.kt)("p",{parentName:"li"}," \u5355\u5757\u67b6\u6784\u4e2d\uff0c\u6574\u4e2a\u7cfb\u7edf\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\uff0c\u5f53\u5e94\u7528\u8fdb\u884c\u90e8\u7f72\u65f6\uff0c\u5fc5\u987b\u505c\u6389\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\uff0c\u90e8\u7f72\u5b8c\u6210\u540e\u518d\u91cd\u542f\u8fdb\u7a0b\uff0c\u65e0\u6cd5\u505a\u5230\u72ec\u7acb\u90e8\u7f72\u3002"),(0,a.kt)("p",{parentName:"li"},"\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u7531\u591a\u4e2a\u670d\u52a1\u7ec4\u6210\uff0c\u6bcf\u4e2a\u670d\u52a1\u90fd\u662f\u9ad8\u5ea6\u81ea\u6cbb\u7684\u72ec\u7acb\u4e1a\u52a1\u5b9e\u4f53\uff0c\u53ef\u4ee5\u8fd0\u884c\u5728\u72ec\u7acb\u7684\u8fdb\u7a0b\u4e2d\uff0c\u4e0d\u540c\u7684\u670d\u52a1\u80fd\u975e\u5e38\u5bb9\u6613\u5730\u90e8\u7f72\u5230\u4e0d\u540c\u7684\u4e3b\u673a\u4e0a\u3002"))),(0,a.kt)("p",null,"\u5fae\u670d\u52a1\u8fd9\u4e48\u591a\u597d\u5904\uff0c\u5c31\u6ca1\u6709\u7f3a\u70b9\u5417\uff1f\u5f53\u7136\u4e0d\u662f\u8fd9\u6837\u7684\uff0c\u4e8b\u52a1\u90fd\u6709\u4e24\u9762\u6027\uff0c\u6211\u4eec\u6765\u770b\u770b\u5fae\u670d\u52a1\u7684\u4e0d\u8db3\u4e4b\u5904\u3002"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u8fd0\u7ef4\u8981\u6c42\u6bd4\u8f83\u9ad8")),(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e\u5355\u4f53\u67b6\u6784\u6765\u8bb2\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u597d\u8fd9\u4e00\u4e2a\u9879\u76ee\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u5bf9\u4e8e\u5fae\u670d\u52a1\u67b6\u6784\u6765\u8bb2\uff0c\u7531\u4e8e\u9879\u76ee\u662f\u7531\u591a\u4e2a\u5fae\u670d\u52a1\u6784\u6210\u7684\uff0c\u6bcf\u4e2a\u6a21\u5757\u51fa\u73b0\u95ee\u9898\u90fd\u4f1a\u9020\u6210\u6574\u4e2a\u9879\u76ee\u8fd0\u884c\u51fa\u73b0\u5f02\u5e38\uff0c\u60f3\u8981\u77e5\u9053\u662f\u54ea\u4e2a\u6a21\u5757\u9020\u6210\u7684\u95ee\u9898\u5f80\u5f80\u662f\u4e0d\u5bb9\u6613\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u4e00\u6b65\u4e00\u6b65\u901a\u8fc7debug\u7684\u65b9\u5f0f\u6765\u8ddf\u8e2a\uff0c\u8fd9\u5c31\u5bf9\u8fd0\u7ef4\u4eba\u5458\u63d0\u51fa\u4e86\u5f88\u9ad8\u7684\u8981\u6c42\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u5206\u5e03\u5f0f\u7684\u590d\u6742\u6027")),(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e\u5355\u4f53\u67b6\u6784\u6765\u8bf4\uff0c\u5206\u5e03\u5f0f\u662f\u7528\u6765\u4f18\u5316\u9879\u76ee\u7684\uff0c\u53ef\u6709\u53ef\u65e0\uff0c\u4f46\u662f\u5bf9\u4e8e\u5fae\u670d\u52a1\u6765\u8bf4\uff0c\u5206\u5e03\u5f0f\u51e0\u4e4e\u662f\u5fc5\u4f1a\u7528\u7684\u6280\u672f\uff0c\u7531\u4e8e\u5206\u5e03\u5f0f\u672c\u8eab\u7684\u590d\u6742\u6027\uff0c\u5bfc\u81f4\u5fae\u670d\u52a1\u67b6\u6784\u4e5f\u53d8\u5f97\u590d\u6742\u8d77\u6765\u3002"),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"bug\u4e0d\u597d\u8c03\u8bd5"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u63a5\u53e3\u6210\u672c\u9ad8")),(0,a.kt)("p",{parentName:"li"},"\u6bd4\u5982\u6211\u4eec\u7684\u524d\u9762\u7684\u7535\u5546\u9879\u76ee\u6bcf\u4e2a\u6a21\u5757\u505a\u6210\u5fae\u670d\u52a1\u7684\u8bdd\uff0c\u7528\u6237\u5fae\u670d\u52a1\u662f\u8981\u88ab\u8ba2\u5355\u5fae\u670d\u52a1\u548c\u8d2d\u7269\u8f66\u5fae\u670d\u52a1\u6240\u8c03\u7528\u7684\uff0c\u4e00\u65e6\u7528\u6237\u5fae\u670d\u52a1\u7684\u63a5\u53e3\u53d1\u751f\u5927\u7684\u53d8\u52a8\uff0c\u90a3\u4e48\u6240\u6709\u4f9d\u8d56\u5b83\u7684\u5fae\u670d\u52a1\u90fd\u8981\u505a\u76f8\u5e94\u7684\u8c03\u6574\uff0c\u7531\u4e8e\u5fae\u670d\u52a1\u53ef\u80fd\u975e\u5e38\u591a\uff0c\u90a3\u4e48\u8c03\u6574\u63a5\u53e3\u6240\u9020\u6210\u7684\u6210\u672c\u5c06\u4f1a\u660e\u663e\u63d0\u9ad8\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u91cd\u590d\u52b3\u52a8")),(0,a.kt)("p",{parentName:"li"},"\u5bf9\u4e8e\u5355\u4f53\u67b6\u6784\u6765\u8bb2\uff0c\u5982\u679c\u67d0\u6bb5\u4e1a\u52a1\u88ab\u591a\u4e2a\u6a21\u5757\u6240\u5171\u540c\u4f7f\u7528\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u62bd\u8c61\u6210\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u88ab\u6240\u6709\u6a21\u5757\u76f4\u63a5\u8c03\u7528\uff0c\u4f46\u662f\u5fae\u670d\u52a1\u5374\u65e0\u6cd5\u8fd9\u6837\u505a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5fae\u670d\u52a1\u7684\u5de5\u5177\u7c7b\u662f\u4e0d\u80fd\u88ab\u5176\u5b83\u5fae\u670d\u52a1\u6240\u76f4\u63a5\u8c03\u7528\u7684\uff0c\u4ece\u800c\u6211\u4eec\u4fbf\u4e0d\u5f97\u4e0d\u5728\u6bcf\u4e2a\u5fae\u670d\u52a1\u4e0a\u90fd\u5efa\u8fd9\u4e48\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u4ece\u800c\u5bfc\u81f4\u4ee3\u7801\u7684\u91cd\u590d\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u4e0d\u597d\u5206\u79bb")),(0,a.kt)("p",{parentName:"li"},"\u7a0b\u5e8f\u5458\u7684\u4e1a\u52a1\u7406\u89e3\u7a0b\u5ea6"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u65e2\u7136\u5fae\u670d\u52a1\u4e5f\u6709\u8fd9\u4e48\u591a\u7684\u7f3a\u70b9\uff0c\u90a3\u4e3a\u4ec0\u4e48\u8fd8\u8981\u7528\u5fae\u670d\u52a1\u67b6\u6784\u5462\uff1f")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u5f00\u53d1\u7b80\u5355")),(0,a.kt)("p",{parentName:"li"},"\u5fae\u670d\u52a1\u67b6\u6784\u5c06\u590d\u6742\u7cfb\u7edf\u8fdb\u884c\u62c6\u5206\u4e4b\u540e\uff0c\u8ba9\u6bcf\u4e2a\u5fae\u670d\u52a1\u5e94\u7528\u90fd\u5f00\u53d1\u53d8\u5f97\u975e\u5e38\u7b80\u5355\uff0c\u6ca1\u6709\u592a\u591a\u7684\u7d2f\u8d58\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u8fd9\u65e0\u7591\u662f\u4e00\u79cd\u89e3\u8131\uff0c\u56e0\u4e3a\u518d\u4e5f\u4e0d\u7528\u8fdb\u884c\u7e41\u91cd\u7684\u52b3\u52a8\u4e86\uff0c\u6bcf\u5929\u90fd\u5728\u4e00\u79cd\u8f7b\u677e\u6109\u5feb\u7684\u6c1b\u56f4\u4e2d\u5de5\u4f5c\uff0c\u5176\u6548\u7387\u4e5f\u4f1a\u6574\u5907\u5730\u63d0\u9ad8")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u80fd\u591f\u5feb\u901f\u76f8\u5e94\u9700\u6c42\u53d8\u5316")),(0,a.kt)("p",{parentName:"li"},"\u4e00\u822c\u7684\u9700\u6c42\u53d8\u5316\u90fd\u6765\u81ea\u4e8e\u5c40\u90e8\u529f\u80fd\u7684\u6539\u53d8\uff0c\u8fd9\u79cd\u53d8\u5316\u5c06\u843d\u5b9e\u5230\u6bcf\u4e2a\u5fae\u670d\u52a1\u4e0a\uff0c\u4e8c\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684\u529f\u80fd\u76f8\u5bf9\u6765\u8bf4\u90fd\u975e\u5e38\u7b80\u5355\uff0c\u66f4\u6539\u8d77\u6765\u975e\u5e38\u5bb9\u6613\uff0c\u6240\u4ee5\u5fae\u670d\u52a1\u975e\u5e38\u9002\u5408\u654f\u6377\u5f00\u53d1\u65b9\u6cd5\uff0c\u80fd\u591f\u5feb\u901f\u7684\u5f71\u54cd\u4e1a\u52a1\u7684\u9700\u6c42\u53d8\u5316\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u968f\u65f6\u968f\u5730\u66f4\u65b0"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u4e0d\u505c\u670d\u66f4\u65b0"),(0,a.kt)("p",{parentName:"li"},"\u4e00\u65b9\u9762\uff0c\u5fae\u670d\u52a1\u7684\u90e8\u7f72\u548c\u66f4\u65b0\u5e76\u4e0d\u4f1a\u5f71\u54cd\u5168\u5c40\u7cfb\u7edf\u7684\u6b63\u5e38\u8fd0\u884c\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u4f7f\u7528\u591a\u5b9e\u4f8b\u7684\u90e8\u7f72\u65b9\u6cd5\uff0c\u53ef\u4ee5\u505a\u5230\u4e00\u4e2a\u670d\u52a1\u7684\u91cd\u542f\u548c\u66f4\u65b0\u5728\u4e0d\u6613\u5bdf\u89c9\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u3002\u6240\u4ee5\u6bcf\u4e2a\u670d\u52a1\u4efb\u4f55\u65f6\u5019\u90fd\u53ef\u4ee5\u8fdb\u884c\u66f4\u65b0\u90e8\u7f72\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"\u7cfb\u7edf\u66f4\u52a0\u7a33\u5b9a\u53ef\u9760")),(0,a.kt)("p",{parentName:"li"},"\u5fae\u670d\u52a1\u8fd0\u884c\u5728\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u5206\u5e03\u5f0f\u73af\u5883\u4e4b\u4e2d\uff0c\u6709\u914d\u5957\u7684\u76d1\u63a7\u548c\u8c03\u5ea6\u7ba1\u7406\u673a\u5236\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u63d0\u4f9b\u81ea\u7531\u4f38\u7f29\u7684\u7ba1\u7406\uff0c\u5145\u5206\u4fdd\u969c\u4e86\u7cfb\u7edf\u7684\u7a33\u5b9a\u53ef\u9760\u6027"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5355\u4f53\u5f0f\u548c\u5fae\u670d\u52a1\u5bf9\u6bd4")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u65b0\u529f\u80fd\u5f00\u53d1"),(0,a.kt)("th",{parentName:"tr",align:null},"\u9700\u8981\u65f6\u95f4"),(0,a.kt)("th",{parentName:"tr",align:null},"\u5bb9\u6613\u5f00\u53d1\u548c\u5b9e\u73b0"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f20\u7edf\u5355\u4f53\u67b6\u6784"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5206\u5e03\u5f0f\u5fae\u670d\u52a1\u5316\u67b6\u6784")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u90e8\u7f72"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e0d\u7ecf\u5e38\u800c\u4e14\u5bb9\u6613\u90e8\u7f72"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7ecf\u5e38\u53d1\u5e03\uff0c\u90e8\u7f72\u590d\u6742")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u9694\u79bb\u6027"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6545\u969c\u5f71\u54cd\u8303\u56f4\u5927"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6545\u969c\u5f71\u54cd\u8303\u56f4\u5c0f")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u67b6\u6784\u8bbe\u8ba1"),(0,a.kt)("td",{parentName:"tr",align:null},"\u521d\u671f\u6280\u672f\u9009\u578b\u96be\u5ea6\u5927"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8bbe\u8ba1\u903b\u8f91\u96be\u5ea6\u5927")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u6027\u80fd"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76f8\u5bf9\u65f6\u95f4\u5feb\uff0c\u541e\u5410\u91cf\u5c0f"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76f8\u5bf9\u65f6\u95f4\u6162\uff0c\u541e\u5410\u91cf\u5927")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u8fd0\u7ef4"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8fd0\u7ef4\u96be\u5ea6\u7b80\u5355"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8fd0\u7ef4\u96be\u5ea6\u590d\u6742")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u65b0\u4eba\u4e0a\u624b"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b66\u4e60\u66f2\u7ebf\u5927\uff08\u5e94\u7528\u903b\u8f91\uff09"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b66\u4e60\u66f2\u7ebf\u5927\uff08\u67b6\u6784\u903b\u8f91\uff09")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u6280\u672f"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6280\u672f\u5355\u4e00\u800c\u4e14\u5c01\u95ed"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6280\u672f\u591a\u6837\u800c\u4e14\u5bb9\u6613\u5f00\u53d1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u6d4b\u8bd5\u548c\u5dee\u9519"),(0,a.kt)("td",{parentName:"tr",align:null},"\u7b80\u5355"),(0,a.kt)("td",{parentName:"tr",align:null},"\u590d\u6742\uff08\u6bcf\u4e2a\u670d\u52a1\u90fd\u8981\u8fdb\u884c\u5355\u72ec\u6d4b\u8bd5\uff0c\u8fd8\u9700\u8981\u96c6\u7fa4\u6d4b\u8bd5\uff09")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u6269\u5c55\u6027"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6269\u5c55\u6027\u5dee"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6269\u5c55\u6027\u597d")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u7ba1\u7406"),(0,a.kt)("td",{parentName:"tr",align:null},"\u91cd\u70b9\u5728\u4e8e\u5f00\u53d1\u6210\u672c"),(0,a.kt)("td",{parentName:"tr",align:null},"\u91cd\u70b9\u5728\u4e8e\u670d\u52a1\u6cbb\u7406\u548c\u8c03\u5ea6")))),(0,a.kt)("h1",{id:"2-rpc\u534f\u8bae"},"2. RPC\u534f\u8bae"),(0,a.kt)("p",null,"\u200b\t\t\u7b80\u5355\u4e86\u89e3\u4e86\u5fae\u670d\u52a1\u5b9a\u4e49\u548c\u4f18\u7f3a\u70b9\u4e4b\u540e\uff0c\u5728\u6211\u4eec\u6b63\u5f0f\u5b66\u4e60\u5fae\u670d\u52a1\u6846\u67b6\u4e4b\u524d\uff0c\u9700\u8981\u9996\u5148\u4e86\u89e3\u4e00\u4e0bRPC\u534f\u8bae\u3002\u4e3a\u4ec0\u4e48\u8981\u4e86\u89e3RPC\u534f\u8bae\uff1fRPC\u534f\u8bae\u5177\u4f53\u662f\u4ec0\u4e48\u5462\uff1f"),(0,a.kt)("h2",{id:"21-rpc\u7684\u6982\u5ff5"},"2.1 RPC\u7684\u6982\u5ff5"),(0,a.kt)("p",null,"\u200b\t\t",(0,a.kt)("strong",{parentName:"p"},"RPC(Remote Procedure Call Protocol)"),"\uff0c\u662f\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u7684\u7f29\u5199\uff0c\u901a\u4fd7\u7684\u8bf4\u5c31\u662f\u8c03\u7528\u8fdc\u5904\u7684\u4e00\u4e2a\u51fd\u6570\u3002\u4e0e\u4e4b\u76f8\u5bf9\u5e94\u7684\u662f\u672c\u5730\u51fd\u6570\u8c03\u7528\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u672c\u5730\u51fd\u6570\u8c03\u7528\u3002\u5f53\u6211\u4eec\u5199\u4e0b\u5982\u4e0b\u4ee3\u7801\u7684\u65f6\u5019\uff1a"),(0,a.kt)("p",null,"\u89c4\u5219"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"result := Add(1,2)\n")),(0,a.kt)("p",null,"\u6211\u4eec\u77e5\u9053\uff0c\u6211\u4eec\u4f20\u5165\u4e861\uff0c2\u4e24\u4e2a\u53c2\u6570\uff0c\u8c03\u7528\u4e86\u672c\u5730\u4ee3\u7801\u4e2d\u7684\u4e00\u4e2aAdd\u51fd\u6570\uff0c\u5f97\u5230result\u8fd9\u4e2a\u8fd4\u56de\u503c\u3002\u8fd9\u65f6\u53c2\u6570\uff0c\u8fd4\u56de\u503c\uff0c\u4ee3\u7801\u6bb5\u90fd\u5728\u4e00\u4e2a\u8fdb\u7a0b\u7a7a\u95f4\u5185\uff0c\u8fd9\u662f\u672c\u5730\u51fd\u6570\u8c03\u7528\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},'\u90a3\u6709\u6ca1\u6709\u529e\u6cd5\uff0c\u6211\u4eec\u80fd\u591f\u8c03\u7528\u4e00\u4e2a\u8de8\u8fdb\u7a0b\uff08\u6240\u4ee5\u53eb"\u8fdc\u7a0b"\uff0c\u5178\u578b\u7684\u4e8b\u4f8b\uff0c\u8fd9\u4e2a\u8fdb\u7a0b\u90e8\u7f72\u5728\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff09\u7684\u51fd\u6570\u5462?')),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564372623923",src:t(2246).Z})),(0,a.kt)("p",null,"\u8fd9\u4e5f\u662fRPC\u4e3b\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u3002"),(0,a.kt)("h2",{id:"22-\u4e3a\u4ec0\u4e48\u5fae\u670d\u52a1\u9700\u8981rpc"},"2.2 \u4e3a\u4ec0\u4e48\u5fae\u670d\u52a1\u9700\u8981RPC"),(0,a.kt)("p",null,"\u6211\u4eec\u4f7f\u7528\u5fae\u670d\u52a1\u5316\u7684\u4e00\u4e2a\u597d\u5904\u5c31\u662f\uff0c\u4e0d\u9650\u5b9a\u670d\u52a1\u7684\u63d0\u4f9b\u65b9\u4f7f\u7528\u4ec0\u4e48\u6280\u672f\u9009\u578b\uff0c\u80fd\u591f\u5b9e\u73b0\u516c\u53f8\u8de8\u56e2\u961f\u7684\u6280\u672f\u89e3\u8026\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564373553013",src:t(6281).Z})),(0,a.kt)("p",null,"\u8fd9\u6837\u7684\u8bdd\uff0c",(0,a.kt)("strong",{parentName:"p"},"\u5982\u679c\u6ca1\u6709\u7edf\u4e00\u7684\u670d\u52a1\u6846\u67b6\uff0cRPC\u6846\u67b6"),"\uff0c\u5404\u4e2a\u56e2\u961f\u7684\u670d\u52a1\u63d0\u4f9b\u65b9\u5c31\u9700\u8981\u5404\u81ea\u5b9e\u73b0\u4e00\u5957\u5e8f\u5217\u5316\u3001\u53cd\u5e8f\u5217\u5316\u3001\u7f51\u7edc\u6846\u67b6\u3001\u8fde\u63a5\u6c60\u3001\u6536\u53d1\u7ebf\u7a0b\u3001\u8d85\u65f6\u5904\u7406\u3001\u72b6\u6001\u673a\u7b49\u201c\u4e1a\u52a1\u4e4b\u5916\u201d\u7684\u91cd\u590d\u6280\u672f\u52b3\u52a8\uff0c\u9020\u6210\u6574\u4f53\u7684\u4f4e\u6548\u3002\u6240\u4ee5\uff0c",(0,a.kt)("strong",{parentName:"p"},"\u7edf\u4e00RPC\u6846\u67b6"),"\u628a\u4e0a\u8ff0\u201c\u4e1a\u52a1\u4e4b\u5916\u201d\u7684\u6280\u672f\u52b3\u52a8\u7edf\u4e00\u5904\u7406\uff0c\u662f\u670d\u52a1\u5316\u9996\u8981\u89e3\u51b3\u7684\u95ee\u9898\u3002"),(0,a.kt)("h2",{id:"23-rpc\u5165\u95e8"},"2.3 RPC\u5165\u95e8"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"protobuf    ")),(0,a.kt)("p",null,"\u5728\u4e92\u8054\u7f51\u65f6\u4ee3\uff0cRPC\u5df2\u7ecf\u548cIPC(\u8fdb\u7a0b\u95f4\u901a\u4fe1)\u4e00\u6837\u6210\u4e3a\u4e00\u4e2a\u4e0d\u53ef\u6216\u7f3a\u7684\u57fa\u7840\u6784\u4ef6\u3002\u56e0\u6b64Go\u8bed\u8a00\u7684\u6807\u51c6\u5e93\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684RPC\u5b9e\u73b0\uff0c\u6211\u4eec\u5c06\u4ee5\u6b64\u4e3a\u5165\u53e3\u5b66\u4e60RPC\u7684\u5e38\u89c1\u7528\u6cd5\u3002"),(0,a.kt)("h3",{id:"231-rpc\u7248\u7684hello-world"},'2.3.1 RPC\u7248\u7684"hello world"'),(0,a.kt)("p",null,"Go\u8bed\u8a00\u7684RPC\u5305\u7684\u8def\u5f84\u4e3anet/rpc\uff0c\u4e5f\u5c31\u662f\u653e\u5728\u4e86net\u5305\u76ee\u5f55\u4e0b\u9762\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u8be5RPC\u5305\u662f\u5efa\u7acb\u5728net\u5305\u57fa\u7840\u4e4b\u4e0a\u7684\u3002\u63a5\u7740\u6211\u4eec\u5c1d\u8bd5\u57fa\u4e8erpc\u5b9e\u73b0\u4e00\u4e2a\u7c7b\u4f3c\u7684\u4f8b\u5b50\u3002\u6211\u4eec\u5148\u6784\u9020\u4e00\u4e2aHelloService\u7c7b\u578b\uff0c\u5176\u4e2d\u7684Hello\u65b9\u6cd5\u7528\u4e8e\u5b9e\u73b0\u6253\u5370\u529f\u80fd\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type HelloService struct{}\nfunc(p *HelloService)Hello(request string,reply *string)error{\n*reply = "hello:" + request\nreturn  nil\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Hello\u65b9\u6cd5\u65b9\u6cd5\u5fc5\u987b\u6ee1\u8db3Go\u8bed\u8a00\u7684RPC\u89c4\u5219\uff1a\u65b9\u6cd5\u53ea\u80fd\u6709\u4e24\u4e2a\u53ef\u5e8f\u5217\u5316\u7684\u53c2\u6570\uff0c\u5176\u4e2d\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6307\u9488\u7c7b\u578b\uff0c\u5e76\u4e14\u8fd4\u56de\u4e00\u4e2aerror\u7c7b\u578b\uff0c\u540c\u65f6\u5fc5\u987b\u662f\u516c\u5f00\u7684\u65b9\u6cd5\u3002"),(0,a.kt)("p",{parentName:"blockquote"},"golang \u4e2d\u7684\u7c7b\u578b\u6bd4\u5982\uff1achannel\uff08\u901a\u9053\uff09\u3001complex\uff08\u590d\u6570\u7c7b\u578b\uff09\u3001func\uff08\u51fd\u6570\uff09\u5747\u4e0d\u80fd\u8fdb\u884c \u5e8f\u5217\u5316")),(0,a.kt)("p",null,"\u7136\u540e\u5c31\u53ef\u4ee5\u5c06HelloService\u7c7b\u578b\u7684\u5bf9\u8c61\u6ce8\u518c\u4e3a\u4e00\u4e2aRPC\u670d\u52a1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //rpc\u6ce8\u518c\u670d\u52a1  \n    //\u6ce8\u518crpc\u670d\u52a1\uff0c\u7ef4\u62a4\u4e00\u4e2ahash\u8868\uff0ckey\u503c\u662f\u670d\u52a1\u540d\u79f0\uff0cvalue\u503c\u662f\u670d\u52a1\u7684\u5730\u5740\n    rpc.RegisterName("HelloService",new(HelloService))\n\n    //\u8bbe\u7f6e\u670d\u52a1\u76d1\u542c\n    listener,err := net.Listen("tcp",":1234")\n    if err != nil {\n        panic(err)\n    }\n\n    //\u63a5\u53d7\u4f20\u8f93\u7684\u6570\u636e\n    conn,err := listener.Accept()\n    if err != nil {\n        panic(err)\n    }\n\n    //rpc\u8c03\u7528,\u5e76\u8fd4\u56de\u6267\u884c\u540e\u7684\u6570\u636e\n    //1.read\uff0c\u83b7\u53d6\u670d\u52a1\u540d\u79f0\u548c\u65b9\u6cd5\u540d\uff0c\u83b7\u53d6\u8bf7\u6c42\u6570\u636e\n    //2.\u8c03\u7528\u5bf9\u5e94\u670d\u52a1\u91cc\u9762\u7684\u65b9\u6cd5\uff0c\u83b7\u53d6\u4f20\u51fa\u6570\u636e\n    //3.write\uff0c\u628a\u6570\u636e\u8fd4\u56de\u7ed9client\n    rpc.ServeConn(conn)\n\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5176\u4e2drpc.Register\u51fd\u6570\u8c03\u7528\u4f1a\u5c06\u5bf9\u8c61\u7c7b\u578b\u4e2d\u6240\u6709\u6ee1\u8db3RPC\u89c4\u5219\u7684\u5bf9\u8c61\u65b9\u6cd5\u6ce8\u518c\u4e3aRPC\u51fd\u6570\uff0c\u6240\u6709\u6ce8\u518c\u7684\u65b9\u6cd5\u4f1a\u653e\u5728\u201cHelloService\u201d\u670d\u52a1\u7a7a\u95f4\u4e4b\u4e0b\u3002\u7136\u540e\u6211\u4eec\u5efa\u7acb\u4e00\u4e2a\u552f\u4e00\u7684TCP\u94fe\u63a5\uff0c\u5e76\u4e14\u901a\u8fc7rpc.ServeConn\u51fd\u6570\u5728\u8be5TCP\u94fe\u63a5\u4e0a\u4e3a\u5bf9\u65b9\u63d0\u4f9bRPC\u670d\u52a1\u3002")),(0,a.kt)("p",null,"\u4e0b\u9762\u662f\u5ba2\u6237\u7aef\u8bf7\u6c42HelloService\u670d\u52a1\u7684\u4ee3\u7801\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u7528rpc\u8fde\u63a5\n    client,err := rpc.Dial("tcp","localhost:1234")\n    if err != nil {\n        panic(err)\n    }\n\n    var reply string\n    //\u8c03\u7528\u670d\u52a1\u4e2d\u7684\u51fd\u6570\n    err = client.Call("HelloService.Hello","world",&reply)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println("\u6536\u5230\u7684\u6570\u636e\u4e3a,",reply)\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u9996\u9009\u662f\u901a\u8fc7rpc.Dial\u62e8\u53f7RPC\u670d\u52a1\uff0c\u7136\u540e\u901a\u8fc7client.Call\u8c03\u7528\u5177\u4f53\u7684RPC\u65b9\u6cd5\u3002\u5728\u8c03\u7528client.Call\u65f6\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u70b9\u53f7\u94fe\u63a5\u7684RPC\u670d\u52a1\u540d\u5b57\u548c\u65b9\u6cd5\u540d\u5b57\uff0c\u7b2c\u4e8c\u548c\u7b2c\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u6211\u4eec\u5b9a\u4e49RPC\u65b9\u6cd5\u7684\u4e24\u4e2a\u53c2\u6570\u3002")),(0,a.kt)("h3",{id:"232-\u8de8\u8bed\u8a00\u7684rpc"},"2.3.2 \u8de8\u8bed\u8a00\u7684RPC"),(0,a.kt)("p",null,"\u200b\t\t\u6807\u51c6\u5e93\u7684RPC\u9ed8\u8ba4\u91c7\u7528Go\u8bed\u8a00\u7279\u6709\u7684gob\u7f16\u7801\u3002\u56e0\u6b64\uff0c\u5176\u5b83\u8bed\u8a00\u8c03\u7528Go\u8bed\u8a00\u5b9e\u73b0\u7684RPC\u670d\u52a1\u5c06\u6bd4\u8f83\u56f0\u96be\u3002\u8de8\u8bed\u8a00\u662f\u4e92\u8054\u7f51\u65f6\u4ee3RPC\u7684\u4e00\u4e2a\u9996\u8981\u6761\u4ef6\uff0c\u8fd9\u91cc\u6211\u4eec\u518d\u6765\u5b9e\u73b0\u4e00\u4e2a\u8de8\u8bed\u8a00\u7684RPC\u3002\u5f97\u76ca\u4e8eRPC\u7684\u6846\u67b6\u8bbe\u8ba1\uff0cGo\u8bed\u8a00\u7684RPC\u5176\u5b9e\u4e5f\u662f\u5f88\u5bb9\u6613\u5b9e\u73b0\u8de8\u8bed\u8a00\u652f\u6301\u7684\u3002"),(0,a.kt)("p",null,"\u200b\t\t\u8fd9\u91cc\u6211\u4eec\u5c06\u5c1d\u8bd5\u901a\u8fc7\u5b98\u65b9\u81ea\u5e26\u7684net/rpc/jsonrpc\u6269\u5c55\u5b9e\u73b0\u4e00\u4e2a\u8de8\u8bed\u8a00RPC\u3002"),(0,a.kt)("p",null,"\u200b\t\t\u9996\u5148\u662f\u57fa\u4e8ejson\u7f16\u7801\u91cd\u65b0\u5b9e\u73b0RPC\u670d\u52a1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u6ce8\u518crpc\u670d\u52a1\n    rpc.RegisterName("HelloService",new(HelloService))\n    //\u8bbe\u7f6e\u76d1\u542c\n    listener,err := net.Listen("tcp",":1234")\n    if err != nil {\n        panic(err)\n    }\n\n    for{\n        //\u63a5\u6536\u8fde\u63a5\n        conn,err := listener.Accept()\n        if err != nil {\n            panic(err)\n        }\n        //\u7ed9\u5f53\u524d\u8fde\u63a5\u63d0\u4f9b\u9488\u5bf9json\u683c\u5f0f\u7684rpc\u670d\u52a1\n        go rpc.ServeCodec(jsonrpc.NewServerCodec(conn))\n    }\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4ee3\u7801\u4e2d\u6700\u5927\u7684\u53d8\u5316\u662f\u7528rpc.ServeCodec\u51fd\u6570\u66ff\u4ee3\u4e86rpc.ServeConn\u51fd\u6570\uff0c\u4f20\u5165\u7684\u53c2\u6570\u662f\u9488\u5bf9\u670d\u52a1\u7aef\u7684json\u7f16\u89e3\u7801\u5668\u3002")),(0,a.kt)("p",null,"\u7136\u540e\u662f\u5b9e\u73b0json\u7248\u672c\u7684\u5ba2\u6237\u7aef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u7b80\u5386tcp\u8fde\u63a5\n    conn,err := net.Dial("tcp","localhost:1234")\n    if err !=nil{\n        panic(err)\n    }\n    //\u7b80\u5386\u57fa\u4e8ejson\u7f16\u89e3\u7801\u7684rpc\u670d\u52a1\n    client := rpc.NewClientWithCodec(jsonrpc.NewClientCodec(conn))\n\n    var reply string\n    //\u8c03\u7528rpc\u670d\u52a1\u65b9\u6cd5\n    err = client.Call("HelloService.Hello"," world",&reply)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println("\u6536\u5230\u7684\u6570\u636e\u4e3a:",reply)\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5148\u624b\u5de5\u8c03\u7528net.Dial\u51fd\u6570\u5efa\u7acbTCP\u94fe\u63a5\uff0c\u7136\u540e\u57fa\u4e8e\u8be5\u94fe\u63a5\u5efa\u7acb\u9488\u5bf9\u5ba2\u6237\u7aef\u7684json\u7f16\u89e3\u7801\u5668\u3002")),(0,a.kt)("p",null,"\u5728\u786e\u4fdd\u5ba2\u6237\u7aef\u53ef\u4ee5\u6b63\u5e38\u8c03\u7528RPC\u670d\u52a1\u7684\u65b9\u6cd5\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u547d\u4ee4\u6765\u67e5\u770b\u4e00\u4e0b\u5ba2\u6237\u7aef\u53d1\u7ed9\u670d\u52a1\u7aef\u7684\u5230\u5e95\u662f\u4ec0\u4e48\u6570\u636e\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 ==nc -l 1234==  \u8fd9\u6761\u547d\u4ee4 \u6a21\u62df\u670d\u52a1\u5668\u76d1\u542c1234\u7aef\u53e3\u63a5\u6536\u7684\u6570\u636e\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c\u5ba2\u6237\u7aef\uff0c\u5c06\u4f1a\u53d1\u73b0nc\u8f93\u51fa\u4e86\u4ee5\u4e0b\u7684\u4fe1\u606f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'{"method":"HelloService.Hello","params":["hello"],"id":0}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"nc\u5e38\u7528\u6709\u4e24\u79cd\u4e00\u79cd\u662f\u8fde\u63a5\u5230\u6307\u5b9aip\u548c\u7aef\u53e3"),(0,a.kt)("p",{parentName:"blockquote"}," nc hostname port"),(0,a.kt)("p",{parentName:"blockquote"},"\u53e6\u5916\u4e00\u79cd\u662f\u76d1\u542c\u7aef\u53e3\uff0c\u7b49\u5f85\u8fde\u63a5"),(0,a.kt)("p",{parentName:"blockquote"},"nc  -l   port")),(0,a.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2ajson\u7f16\u7801\u7684\u6570\u636e\uff0c\u5176\u4e2dmethod\u90e8\u5206\u5bf9\u5e94\u8981\u8c03\u7528\u7684rpc\u670d\u52a1\u548c\u65b9\u6cd5\u7ec4\u5408\u6210\u7684\u540d\u5b57\uff0cparams\u90e8\u5206\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3a\u53c2\u6570\uff0cid\u662f\u7531\u8c03\u7528\u7aef\u7ef4\u62a4\u7684\u4e00\u4e2a\u552f\u4e00\u7684\u8c03\u7528\u7f16\u53f7\u3002"),(0,a.kt)("p",null,"\u8bf7\u6c42\u7684json\u6570\u636e\u5bf9\u8c61\u5728\u5185\u90e8\u5bf9\u5e94\u4e24\u4e2a\u7ed3\u6784\u4f53\uff1a\u5ba2\u6237\u7aef\u662fclientRequest\uff0c\u670d\u52a1\u7aef\u662fserverRequest\u3002clientRequest\u548cserverRequest\u7ed3\u6784\u4f53\u7684\u5185\u5bb9\u57fa\u672c\u662f\u4e00\u81f4\u7684\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type clientRequest struct {\n    Method string         `json:"method"`\n    Params []interface{}  `json:"params"`\n    Id     uint64         `json:"id"`\n}\ntype serverRequest struct {\n    Method string           `json:"method"`\n    Params *json.RawMessage `json:"params"`\n    Id     *json.RawMessage `json:"id"`\n}\n')),(0,a.kt)("p",null,"\u4e86\u89e3\u4e86\u5ba2\u6237\u7aef\u9700\u8981\u53d1\u9001\u54ea\u4e9b\u6570\u636e\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u518d\u6765\u770b\u770b\u670d\u52a1\u5668\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u4f20\u8f93\u7684\u6570\u636e\u4e4b\u540e\u4f1a\u8fd4\u56de\u54ea\u4e9b\u6570\u636e\uff0c\u8fd8\u662f\u7528\u6211\u4eec\u7684nc\u547d\u4ee4\u3002\u64cd\u4f5c\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'echo -e \'{"method":"HelloService.Hello","params":["hello"],"id":1}\'| nc localhost 1234\n')),(0,a.kt)("p",null,"\u8fd4\u56de\u7684\u6570\u636e\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564396573015",src:t(6882).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5176\u4e2did\u5bf9\u5e94\u8f93\u5165\u7684id\u53c2\u6570\uff0cresult\u4e3a\u8fd4\u56de\u7684\u7ed3\u679c\uff0cerror\u90e8\u5206\u5728\u51fa\u95ee\u9898\u65f6\u8868\u793a\u9519\u8bef\u4fe1\u606f\u3002\u5bf9\u4e8e\u987a\u5e8f\u8c03\u7528\u6765\u8bf4\uff0cid\u4e0d\u662f\u5fc5\u987b\u7684\u3002\u4f46\u662fGo\u8bed\u8a00\u7684RPC\u6846\u67b6\u652f\u6301\u5f02\u6b65\u8c03\u7528\uff0c\u5f53\u8fd4\u56de\u7ed3\u679c\u7684\u987a\u5e8f\u548c\u8c03\u7528\u7684\u987a\u5e8f\u4e0d\u4e00\u81f4\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7id\u6765\u8bc6\u522b\u5bf9\u5e94\u7684\u8c03\u7528\u3002")),(0,a.kt)("p",null,"\u8fd4\u56de\u7684json\u6570\u636e\u4e5f\u662f\u5bf9\u5e94\u5185\u90e8\u7684\u4e24\u4e2a\u7ed3\u6784\u4f53\uff1a\u5ba2\u6237\u7aef\u662fclientResponse\uff0c\u670d\u52a1\u7aef\u662fserverResponse\u3002\u4e24\u4e2a\u7ed3\u6784\u4f53\u7684\u5185\u5bb9\u540c\u6837\u4e5f\u662f\u7c7b\u4f3c\u7684\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type clientResponse struct {\n    Id     uint64           `json:"id"`\n    Result *json.RawMessage `json:"result"`\n    Error  interface{}      `json:"error"`\n}\ntype serverResponse struct {\n    Id     *json.RawMessage `json:"id"`\n    Result interface{}      `json:"result"`\n    Error  interface{}      `json:"error"`\n}\n')),(0,a.kt)("p",null,"\u56e0\u6b64\u65e0\u8bba\u91c7\u7528\u4f55\u79cd\u8bed\u8a00\uff0c\u53ea\u8981\u9075\u5faa\u540c\u6837\u7684json\u7ed3\u6784\uff0c\u4ee5\u540c\u6837\u7684\u6d41\u7a0b\u5c31\u53ef\u4ee5\u548cGo\u8bed\u8a00\u7f16\u5199\u7684RPC\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u89e3\u7528json\u7b80\u5355\u5b9e\u73b0\u4e86\u8de8\u8bed\u8a00\u7684RPC\u3002"),(0,a.kt)("p",null,"\u4f46\u662f\u4e00\u822c\u5728\u5f00\u53d1\u7684\u65f6\u5019\u9664\u4e86\u7528json\u505a\u8de8\u8bed\u8a00\u7684RPC\u670d\u52a1\u4e4b\u5916\uff0c\u73b0\u5728\u5f88\u591a\u516c\u53f8\u8fd8\u4f1a\u9009\u7528",(0,a.kt)("strong",{parentName:"p"},"protobuf"),"\u505a\u8de8\u8bed\u8a00\u7684RPC\u670d\u52a1\u3002\u90a3\u4ec0\u4e48\u662f",(0,a.kt)("strong",{parentName:"p"},"ProtoBuf"),"\u5462?\u63a5\u4e0b\u6765\u6211\u4eec\u8be6\u7ec6\u4e86\u89e3\u4e00\u4e0b\u3002"),(0,a.kt)("h3",{id:"234-rpc\u534f\u8bae\u5c01\u88c5"},"2.3.4 RPC\u534f\u8bae\u5c01\u88c5"),(0,a.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u670d\u52a1\u540d\u90fd\u662f\u5199\u6b7b\u7684\uff0c\u4e0d\u591f\u7075\u6d3b\uff08\u5bb9\u6613\u5199\u9519\uff09\uff0c\u8fd9\u91cc\u6211\u4eec\u5bf9RPC\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u518d\u6b21\u8fdb\u884c\u4e00\u6b21\u5c01\u88c5\uff0c\u6765\u5c4f\u853d\u6389\u670d\u52a1\u540d\uff0c\u5177\u4f53\u4ee3\u7801\u5982\u4e0b"),(0,a.kt)("h5",{id:"\u670d\u52a1\u7aef\u5c01\u88c5"},"\u670d\u52a1\u7aef\u5c01\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'//\u62bd\u79bb\u670d\u52a1\u540d\u79f0\nvar serverName = "LoginService"\n\n//\u5b9a\u4e49\u4e00\u4e2a\u7236\u7c7b\ntype RPCDesign interface {\n    Hello(string,*string)error\n}\n\n//\u5b9e\u73b0\u5de5\u5382\u51fd\u6570\nfunc RegisterRPCServer(srv RPCDesign)error{\n    return rpc.RegisterName(serverName,srv)\n}\n')),(0,a.kt)("p",null,"\u5c01\u88c5\u4e4b\u540e\u7684\u670d\u52a1\u7aef\u5b9e\u73b0\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type RpcServer struct{}\n\n//5 + 3i    chan   func    complex\nfunc (this *RpcServer) Hello(req string, resp *string) error {\n    *resp += req + "\u4f60\u597d"\n    return nil\n}\n\nfunc main() {\n    //\u8bbe\u7f6e\u76d1\u542c\n    listener, err := net.Listen("tcp", ":8899")\n    if err != nil {\n        fmt.Println("\u8bbe\u7f6e\u76d1\u542c\u9519\u8bef")\n        return\n    }\n    defer listener.Close()\n\n    fmt.Println("\u5f00\u59cb\u76d1\u542c....")\n    for {\n        //\u63a5\u6536\u94fe\u63a5\n        conn, err := listener.Accept()\n        if err != nil {\n            fmt.Println("\u83b7\u53d6\u8fde\u63a5\u5931\u8d25")\n            return\n        }\n        defer conn.Close()\n\n        fmt.Println(conn.RemoteAddr().String() + "\u8fde\u63a5\u6210\u529f")\n\n        //rpc\u8868  \u6ce8\u518crpc\u670d\u52a1\n\n        if err = RegisterRPCServer(new(RpcServer)); err != nil {\n            fmt.Println("\u6ce8\u518crpc\u670d\u52a1\u5931\u8d25")\n            return\n        }\n\n        //\u628arpc\u670d\u52a1\u548c\u5957\u63a5\u5b57\u7ed1\u5b9a\n        //rpc.ServeConn(conn)\n        rpc.ServeCodec(jsonrpc.NewServerCodec(conn))\n    }\n\n}\n')),(0,a.kt)("h5",{id:"\u5ba2\u6237\u7aef\u5c01\u88c5"},"\u5ba2\u6237\u7aef\u5c01\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type RPCClient struct {\n    rpcClient *rpc.Client\n}\n\nfunc NewRpcClient(addr string)(RPCClient){\n    conn,err := net.Dial("tcp",addr)\n    if err != nil {\n        fmt.Println("\u94fe\u63a5\u670d\u52a1\u5668\u5931\u8d25")\n        return RPCClient{}\n    }\n    defer conn.Close()\n\n    //\u5957\u63a5\u5b57\u548crpc\u670d\u52a1\u7ed1\u5b9a\n    client := rpc.NewClientWithCodec(jsonrpc.NewClientCodec(conn))\n    return RPCClient{rpcClient:client}\n}\n\nfunc (this*RPCClient)CallFunc(req string,resp*string)error{\n    return this.rpcClient.Call(serverName+".Hello",req,resp)\n}\n')),(0,a.kt)("p",null,"\u5c01\u88c5\u4e4b\u540e\u5ba2\u6237\u7aef\u5b9e\u73b0"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main()  {\n    //\u521d\u59cb\u5316\u5bf9\u8c61  \u4e0e\u670d\u52a1\u540d\u6709\u5173\u7684\u5185\u5bb9\u5b8c\u5168\u5c01\u88c5\u8d77\u6765\u4e86\n    client := NewRpcClient("127.0.0.1:8899")\n\n    //\u8c03\u7528\u6210\u5458\u51fd\u6570\n    var temp string\n    client.CallFunc("xiaoming",&temp)\n\n\n    fmt.Println(temp)\n}\n')),(0,a.kt)("h1",{id:"3-protobuf\u8ba4\u8bc6\u4e0e\u4f7f\u7528"},"3. ProtoBuf\u8ba4\u8bc6\u4e0e\u4f7f\u7528"),(0,a.kt)("h2",{id:"31-protobuf\u7b80\u4ecb"},"3.1 protobuf\u7b80\u4ecb"),(0,a.kt)("p",null,"Protobuf\u662fProtocol Buffers\u7684\u7b80\u79f0\uff0c\u5b83\u662fGoogle\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u79cd\u6570\u636e\u63cf\u8ff0\u8bed\u8a00\uff0c\u662f\u4e00\u79cd\u8f7b\u4fbf\u9ad8\u6548\u7684\u7ed3\u6784\u5316\u6570\u636e\u5b58\u50a8\u683c\u5f0f\uff0c\u53ef\u4ee5\u7528\u4e8e\u7ed3\u6784\u5316\u6570\u636e\u4e32\u884c\u5316\uff0c\u6216\u8005\u8bf4\u5e8f\u5217\u5316\u3002\u5b83\u5f88\u9002\u5408\u505a",(0,a.kt)("strong",{parentName:"p"},"\u6570\u636e\u5b58\u50a8"),"\u6216 ",(0,a.kt)("strong",{parentName:"p"},"RPC \u6570\u636e\u4ea4\u6362\u683c\u5f0f"),"\u3002\u53ef\u7528\u4e8e\u901a\u8baf\u534f\u8bae\u3001\u6570\u636e\u5b58\u50a8\u7b49\u9886\u57df\u7684\u8bed\u8a00\u65e0\u5173\u3001\u5e73\u53f0\u65e0\u5173\u3001\u53ef\u6269\u5c55\u7684\u5e8f\u5217\u5316\u7ed3\u6784\u6570\u636e\u683c\u5f0f\u3002\u76ee\u524d\u63d0\u4f9b\u4e86 C++\u3001Java\u3001Python \u4e09\u79cd\u8bed\u8a00\u7684 API\u3002"),(0,a.kt)("p",null,"Protobuf\u521a\u5f00\u6e90\u65f6\u7684\u5b9a\u4f4d\u7c7b\u4f3c\u4e8eXML\u3001JSON\u7b49\u6570\u636e\u63cf\u8ff0\u8bed\u8a00\uff0c\u901a\u8fc7\u9644\u5e26\u5de5\u5177\u751f\u6210\u4ee3\u7801\u5e76\u5b9e\u73b0\u5c06\u7ed3\u6784\u5316\u6570\u636e\u5e8f\u5217\u5316\u7684\u529f\u80fd\u3002\u8fd9\u91cc\u6211\u4eec\u66f4\u5173\u6ce8\u7684\u662fProtobuf\u4f5c\u4e3a\u63a5\u53e3\u89c4\u8303\u7684\u63cf\u8ff0\u8bed\u8a00\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u8bbe\u8ba1\u5b89\u5168\u7684\u8de8\u8bed\u8a00RPC\u63a5\u53e3\u7684\u57fa\u7840\n\u5de5\u5177\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u9700\u8981\u4e86\u89e3\u4e24\u70b9"),(0,a.kt)("ol",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ol"},"protobuf\u662f\u7c7b\u4f3c\u4e0ejson\u4e00\u6837\u7684\u6570\u636e\u63cf\u8ff0\u8bed\u8a00\uff08\u6570\u636e\u683c\u5f0f\uff09"),(0,a.kt)("li",{parentName:"ol"},"protobuf\u975e\u5e38\u9002\u5408\u4e8eRPC\u6570\u636e\u4ea4\u6362\u683c\u5f0f"))),(0,a.kt)("p",null,"\u63a5\u7740\u6211\u4eec\u6765\u770b\u4e00\u4e0bprotobuf\u7684\u4f18\u52bf\u548c\u52a3\u52bf\uff1a"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u4f18\u52bf\uff1a ")),(0,a.kt)("p",null,"1\uff1a\u5e8f\u5217\u5316\u540e\u4f53\u79ef\u76f8\u6bd4Json\u548cXML\u5f88\u5c0f\uff0c\u9002\u5408\u7f51\u7edc\u4f20\u8f93 "),(0,a.kt)("p",null,"2\uff1a\u652f\u6301\u8de8\u5e73\u53f0\u591a\u8bed\u8a00 "),(0,a.kt)("p",null,"3\uff1a\u6d88\u606f\u683c\u5f0f\u5347\u7ea7\u548c\u517c\u5bb9\u6027\u8fd8\u4e0d\u9519 "),(0,a.kt)("p",null,"4\uff1a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u901f\u5ea6\u5f88\u5feb\uff0c\u5feb\u4e8eJson\u7684\u5904\u7406\u901f\u5ea6"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u52a3\u52bf\uff1a")),(0,a.kt)("p",null,"1\uff1a\u5e94\u7528\u4e0d\u591f\u5e7f(\u76f8\u6bd4xml\u548cjson)"),(0,a.kt)("p",null,"2\uff1a\u4e8c\u8fdb\u5236\u683c\u5f0f\u5bfc\u81f4\u53ef\u8bfb\u6027\u5dee"),(0,a.kt)("p",null,"3\uff1a\u7f3a\u4e4f\u81ea\u63cf\u8ff0"),(0,a.kt)("p",null,"\u6211\u4eec\u5148\u5b89\u88c5\u4e00\u4e0bprotobuf\uff0c\u7136\u540e\u901a\u8fc7\u4f8b\u5b50\u6765\u770b\u4e00\u4e0bprotobuf\u7684\u5177\u4f53\u4f5c\u7528\u3002"),(0,a.kt)("h2",{id:"32-protobuf\u7684\u5b89\u88c5"},"3.2 protobuf\u7684\u5b89\u88c5"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u4e0b\u8f7d protobuf"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"\u65b9\u6cd5\u4e00:===> git clone https://github.com/protocolbuffers/protobuf.git\n\n\u65b9\u6cd5\u4e8c:===> \u6216\u8005\u5c06\u51c6\u5907\u597d\u7684\u538b\u7f29\u5305\u8fdb\u884c\u62d6\u5165\n    \u89e3\u538b\u5230$GOPATH/src/github.com/protocolbuffers/\u4e0b\u9762\n    Unzip protobuf.zip\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5b89\u88c5\uff08ubuntu\uff09"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"(1)\u5b89\u88c5\u4f9d\u8d56\u5de5\u5177\uff08\u8054\u7f51\uff09\n$ sudo apt-get install autoconf automake libtool curl make g++ unzip libffi-dev -y\n\n(2)\u8fdb\u5165protobuf\u6587\u4ef6\ncd protobuf/\n\n(3)\u8fdb\u884c\u5b89\u88c5\u68c0\u6d4b \u5e76\u751f\u6210\u81ea\u52a8\u5b89\u88c5\u811a\u672c\n./autogen.sh\n./configure\n\n(4)\u8fdb\u884c\u7f16\u8bd1C\u4ee3\u7801\nmake\n\n(5)\u8fdb\u884c\u5b89\u88c5\nsudo make install\n\n(6)\u5237\u65b0linux\u5171\u4eab\u5e93\u5173\u7cfb\nsudo ldconfig\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u6d4b\u8bd5protobuf\u7f16\u8bd1\u5de5\u5177"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"protoc -h\n")),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u6b63\u5e38\u8f93\u51fa \u76f8\u5173\u6307\u4ee4 \u6ca1\u6709\u62a5\u4efb\u4f55error\uff0c\u4e3a\u5b89\u88c5\u6210\u529f"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5b89\u88c5protobuf\u7684go\u8bed\u8a00\u63d2\u4ef6"),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"\u7531\u4e8eprotobuf\u5e76\u6ca1\u76f4\u63a5\u652f\u6301go\u8bed\u8a00\u9700\u8981\u6211\u4eec\u624b\u52a8\u5b89\u88c5\u76f8\u5173\u63d2\u4ef6")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"(1)\u4e0b\u8f7d\n\u65b9\u6cd5\u4e00:===> go get -v -u github.com/golang/protobuf/proto\n\u65b9\u6cd5\u4e8c:===>\u6216\u8005\u5c06 github.com-golang-protobuf.zip\u62d6\u5165 \u8fdb\u884c\u89e3\u538b\u5230 $GOPATH/src/github.com/golang\n\n(2)\u8fdb\u5165\u5230\u6587\u4ef6\u5939\u5185\u8fdb\u884c\u7f16\u8bd1\n$ cd $GOPATH/src/github.com/golang/protobuf/protoc-gen-go\n$ go build\n\n(3)\u5c06\u751f\u6210\u7684 protoc-gen-go\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u653e\u5728/bin\u76ee\u5f55\u4e0b\n$ sudo cp protoc-gen-go /bin/\n\n(4)\u5c1d\u8bd5\u8865\u9f50protoc-gen-go \u5982\u679c\u53ef\u4ee5\u8865\u9f50\u4ee3\u8868\u6210\u529f\uff0c\u5982\u679c\u6267\u884c\u4e0d\u62a5\u9519 \u4ee3\u8868\u5de5\u5177\u6210\u529f\n")))),(0,a.kt)("h2",{id:"33-protobuf-\u7b80\u5355\u8bed\u6cd5"},"3.3 protobuf \u7b80\u5355\u8bed\u6cd5"),(0,a.kt)("p",null,"\u53c2\u8003\u6587\u6863\uff08\u9700\u7ffb\u5899\uff09\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://developers.google.com/protocol-buffers/docs/proto3"},"https://developers.google.com/protocol-buffers/docs/proto3")),(0,a.kt)("p",null,"\u9996\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";                      //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\uff0c\u4e0d\u6307\u5b9a\u4f1a\u62a5\u9519\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n//message\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u6d88\u606f\u7c7b\u578b\nmessage Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n}\n\nenum test{\n    int32 age = 0;\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"protobuf\u6d88\u606f\u7684\u5b9a\u4e49\uff08\u6216\u8005\u79f0\u4e3a\u63cf\u8ff0\uff09\u901a\u5e38\u90fd\u5199\u5728\u4e00\u4e2a\u4ee5 .proto \u7ed3\u5c3e\u7684\u6587\u4ef6\u4e2d\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u8be5\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\u6307\u5b9a\u6b63\u5728\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"li"},"proto3"),"\u8bed\u6cd5\uff1a\u5982\u679c\u4e0d\u8fd9\u6837\u505a\uff0c\u534f\u8bae\u7f13\u51b2\u533a\u7f16\u8bd1\u5668\u5c06\u5047\u5b9a\u6b63\u5728\u4f7f\u7528proto2\u3002\u8fd9\u4e5f\u5fc5\u987b\u662f\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u7684\u975e\u6ce8\u91ca\u884c\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u7b2c\u4e8c\u884cpackage\u6307\u660e\u5f53\u524d\u662fpb\u5305\uff08\u751f\u6210go\u6587\u4ef6\u4e4b\u540e\u548cGo\u7684\u5305\u540d\u4fdd\u6301\u4e00\u81f4\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u6700\u540emessage\u5173\u952e\u5b57\u5b9a\u4e49\u4e00\u4e2aPerson\u6d88\u606f\u4f53\uff0c\u7c7b\u4f3c\u4e8ego\u8bed\u8a00\u4e2d\u7684\u7ed3\u6784\u4f53\uff0c\u662f\u5305\u542b\u4e00\u7cfb\u5217\u7c7b\u578b\u6570\u636e\u7684\u96c6\u5408\u3002\u8bb8\u591a\u6807\u51c6\u7684\u7b80\u5355\u6570\u636e\u7c7b\u578b\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\uff0c\u5305\u62ec",(0,a.kt)("inlineCode",{parentName:"li"},"bool"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"li"},"int32"),"\uff0c ",(0,a.kt)("inlineCode",{parentName:"li"},"float"),"\uff0c",(0,a.kt)("inlineCode",{parentName:"li"},"double"),"\uff0c\u548c",(0,a.kt)("inlineCode",{parentName:"li"},"string"),"\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6message\u7c7b\u578b\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5728message\u4e2d\u6709\u4e00\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u7684value\u6210\u5458\uff0c\u8be5\u6210\u5458\u7f16\u7801\u65f6\u75281\u4ee3\u66ff\u540d\u5b57\u3002\u6211\u4eec\u77e5\u9053\uff0c\u5728json\u4e2d\u662f\u901a\u8fc7\u6210\u5458\u7684\u540d\u5b57\u6765\u7ed1\u5b9a\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u4f46\u662fProtobuf\u7f16\u7801\u5374\u662f\u901a\u8fc7\u6210\u5458\u7684\u552f\u4e00\u7f16\u53f7\u6765\u7ed1\u5b9a\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u56e0\u6b64Protobuf\u7f16\u7801\u540e\u6570\u636e\u7684\u4f53\u79ef\u4f1a\u6bd4\u8f83\u5c0f\uff0c\u80fd\u591f\u5feb\u901f\u4f20\u8f93\uff0c\u7f3a\u70b9\u662f\u4e0d\u5229\u4e8e\u9605\u8bfb\u3002"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"message\u7684\u683c\u5f0f\u8bf4\u660e")),(0,a.kt)("p",null,"\u6d88\u606f\u7531\u81f3\u5c11\u4e00\u4e2a\u5b57\u6bb5\u7ec4\u5408\u800c\u6210\uff0c\u7c7b\u4f3c\u4e8eGo\u8bed\u8a00\u4e2d\u7684\u7ed3\u6784\u4f53\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u4e00\u5b9a\u7684\u683c\u5f0f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-message\u683c\u5f0f\u8bf4\u660e"},"//\u6ce8\u91ca\u683c\u5f0f \u6ce8\u91ca\u5c3d\u91cf\u4e5f\u5199\u5728\u5185\u5bb9\u4e0a\u65b9\n\uff08\u5b57\u6bb5\u4fee\u9970\u7b26\uff09\u6570\u636e\u7c7b\u578b \u5b57\u6bb5\u540d\u79f0 = \u552f\u4e00\u7684\u7f16\u53f7\u6807\u7b7e\u503c;\n")),(0,a.kt)("blockquote",null,(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"\u552f\u4e00\u7684\u7f16\u53f7\u6807\u7b7e\uff1a\u4ee3\u8868\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4e00\u4e2a\u552f\u4e00\u7684\u7f16\u53f7\u6807\u7b7e\uff0c\u5728\u540c\u4e00\u4e2a\u6d88\u606f\u91cc\u4e0d\u53ef\u4ee5\u91cd\u590d\u3002\u8fd9\u4e9b\u7f16\u53f7\u6807\u7b7e\u7528\u4e0e\u5728\u6d88\u606f\u4e8c\u8fdb\u5236\u683c\u5f0f\u4e2d\u6807\u8bc6\u4f60\u7684\u5b57\u6bb5\uff0c\u5e76\u4e14\u6d88\u606f\u4e00\u65e6\u5b9a\u4e49\u5c31\u4e0d\u80fd\u66f4\u6539\u3002\u9700\u8981\u8bf4\u660e\u7684\u662f\u6807\u7b7e\u57281\u523015\u8303\u56f4\u7684\u91c7\u7528\u4e00\u4e2a\u5b57\u8282\u8fdb\u884c\u7f16\u7801\uff0c\u6240\u4ee5\u901a\u5e38\u5c06\u6807\u7b7e1\u523015\u7528\u4e8e\u9891\u7e41\u53d1\u751f\u7684\u6d88\u606f\u5b57\u6bb5\u3002\u7f16\u53f7\u6807\u7b7e\u5927\u5c0f\u7684\u8303\u56f4\u662f1\u52302\u768429\u6b21\u300219000-19999\u662f\u5b98\u65b9\u9884\u7559\u7684\u503c\uff0c\u4e0d\u80fd\u4f7f\u7528\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u91ca\u683c\u5f0f\uff1a\u5411.proto\u6587\u4ef6\u6dfb\u52a0\u6ce8\u91ca\uff0c\u53ef\u4ee5\u4f7f\u7528C/C++/java/Go\u98ce\u683c\u7684\u53cc\u659c\u6760\uff08//\uff09 \u8bed\u6cd5\u683c\u5f0f\u6216\u8005",(0,a.kt)("inlineCode",{parentName:"li"},"/*.....*/")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"message\u5e38\u89c1\u7684\u6570\u636e\u7c7b\u578b\u4e0ego\u4e2d\u7c7b\u578b\u5bf9\u6bd4 ")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},".proto\u7c7b\u578b"),(0,a.kt)("th",{parentName:"tr",align:null},"Go\u7c7b\u578b"),(0,a.kt)("th",{parentName:"tr",align:null},"\u4ecb\u7ecd"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"double"),(0,a.kt)("td",{parentName:"tr",align:null},"float64"),(0,a.kt)("td",{parentName:"tr",align:null},"64\u4f4d\u6d6e\u70b9\u6570")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"float"),(0,a.kt)("td",{parentName:"tr",align:null},"float32"),(0,a.kt)("td",{parentName:"tr",align:null},"32\u4f4d\u6d6e\u70b9\u6570")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"int32"),(0,a.kt)("td",{parentName:"tr",align:null},"int32"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002\u7f16\u7801\u8d1f\u6570\u6548\u7387\u4f4e\u4e0b\u2014\u2014\u5982\u679c\u4f60\u7684\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u8bf7\u6539\u7528sint32\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"int64"),(0,a.kt)("td",{parentName:"tr",align:null},"int64"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002\u7f16\u7801\u8d1f\u6570\u6548\u7387\u4f4e\u4e0b\u2014\u2014\u5982\u679c\u4f60\u7684\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u8bf7\u6539\u7528sint64\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"uint32"),(0,a.kt)("td",{parentName:"tr",align:null},"uint32"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"uint64"),(0,a.kt)("td",{parentName:"tr",align:null},"uint64"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"sint32"),(0,a.kt)("td",{parentName:"tr",align:null},"int32"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002\u7b26\u53f7\u6574\u578b\u503c\u3002\u8fd9\u4e9b\u6bd4\u5e38\u89c4int32s\u7f16\u7801\u8d1f\u6570\u66f4\u6709\u6548\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"sint64"),(0,a.kt)("td",{parentName:"tr",align:null},"int64"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u3002\u7b26\u53f7\u6574\u578b\u503c\u3002\u8fd9\u4e9b\u6bd4\u5e38\u89c4int64s\u7f16\u7801\u8d1f\u6570\u66f4\u6709\u6548\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"fixed32"),(0,a.kt)("td",{parentName:"tr",align:null},"uint32"),(0,a.kt)("td",{parentName:"tr",align:null},"\u603b\u662f\u56db\u5b57\u8282\u3002\u5982\u679c\u503c\u901a\u5e38\u5927\u4e8e228\uff0c\u5219\u6bd4uint 32\u66f4\u6709\u6548")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"fixed64"),(0,a.kt)("td",{parentName:"tr",align:null},"uint64"),(0,a.kt)("td",{parentName:"tr",align:null},"\u603b\u662f\u516b\u5b57\u8282\u3002\u5982\u679c\u503c\u901a\u5e38\u5927\u4e8e256\uff0c\u5219\u6bd4uint64\u66f4\u6709\u6548")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"sfixed32"),(0,a.kt)("td",{parentName:"tr",align:null},"int32"),(0,a.kt)("td",{parentName:"tr",align:null},"\u603b\u662f\u56db\u5b57\u8282\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"sfixed64"),(0,a.kt)("td",{parentName:"tr",align:null},"int64"),(0,a.kt)("td",{parentName:"tr",align:null},"\u603b\u662f\u516b\u5b57\u8282\u3002")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"bool"),(0,a.kt)("td",{parentName:"tr",align:null},"bool"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5e03\u5c14\u7c7b\u578b")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"string"),(0,a.kt)("td",{parentName:"tr",align:null},"string"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32\u5fc5\u987b\u59cb\u7ec8\u5305\u542bUTF - 8\u7f16\u7801\u62167\u4f4dASCII\u6587\u672c")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"bytes"),(0,a.kt)("td",{parentName:"tr",align:null},"[]byte"),(0,a.kt)("td",{parentName:"tr",align:null},"\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u5b57\u8282\u5e8f\u5217")))),(0,a.kt)("h3",{id:"331protobuf\u9ad8\u7ea7\u7528\u6cd5"},"3.3.1protobuf\u9ad8\u7ea7\u7528\u6cd5"),(0,a.kt)("p",null,"protobuf\u9664\u4e86\u4e0a\u9762\u7684\u7b80\u5355\u7c7b\u578b\u8fd8\u6709\u4e00\u4e9b\u590d\u6742\u7684\u7528\u6cd5\uff0c\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"message\u5d4c\u5957")),(0,a.kt)("p",null,"messsage\u9664\u4e86\u80fd\u653e\u7b80\u5355\u6570\u636e\u7c7b\u578b\u5916\uff0c\u8fd8\u80fd\u5b58\u653e\u53e6\u5916\u7684message\u7c7b\u578b\uff0c\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";                      //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\uff0c\u4e0d\u6307\u5b9a\u4f1a\u62a5\u9519\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n//message\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u6d88\u606f\u7c7b\u578b\nmessage Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n    //\u5b9a\u4e49\u4e00\u4e2amessage\n    message PhoneNumber {\n    string number = 1;\n    int64 type = 2;\n    }\n    PhoneNumber phone = 3;\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"repeated\u5173\u952e\u5b57")),(0,a.kt)("p",null,"repeadted\u5173\u952e\u5b57\u7c7b\u4f3c\u4e0ego\u4e2d\u7684\u5207\u7247\uff0c\u7f16\u8bd1\u4e4b\u540e\u5bf9\u5e94\u7684\u4e5f\u662fgo\u7684\u5207\u7247\uff0c\u7528\u6cd5\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";                      //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\uff0c\u4e0d\u6307\u5b9a\u4f1a\u62a5\u9519\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n//message\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u6d88\u606f\u7c7b\u578b\nmessage Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n    //\u5b9a\u4e49\u4e00\u4e2amessage\n    message PhoneNumber {\n    string number = 1;\n    int64 type = 2;\n    }\n    \n    repeated PhoneNumber phone = 3;\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u9ed8\u8ba4\u503c")),(0,a.kt)("p",null,"\u89e3\u6790\u6570\u636e\u65f6\uff0c\u5982\u679c\u7f16\u7801\u7684\u6d88\u606f\u4e0d\u5305\u542b\u7279\u5b9a\u7684\u5355\u6570\u5143\u7d20\uff0c\u5219\u89e3\u6790\u5bf9\u8c61\u5bf9\u8c61\u4e2d\u7684\u76f8\u5e94\u5b57\u6bb5\u5c06\u8bbe\u7f6e\u4e3a\u8be5\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\u4e0d\u540c\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u4e0d\u540c\uff0c\u5177\u4f53\u5982\u4e0b\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u5b57\u8282\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u8282\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8ebools\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a\u96f6\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u679a\u4e3e\uff0c\u9ed8\u8ba4\u503c\u662f\u7b2c",(0,a.kt)("strong",{parentName:"li"},"\u4e00\u4e2a\u5b9a\u4e49\u7684\u679a\u4e3e\u503c"),"\uff0c\u8be5",(0,a.kt)("strong",{parentName:"li"},"\u503c"),"\u5fc5\u987b\u4e3a0\u3002"),(0,a.kt)("li",{parentName:"ul"},"repeated\u5b57\u6bb5\u9ed8\u8ba4\u503c\u662f\u7a7a\u5217\u8868"),(0,a.kt)("li",{parentName:"ul"},"message\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5bf9\u8c61")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"enum\u5173\u952e\u5b57")),(0,a.kt)("p",null,"\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u65f6\uff0c\u53ef\u80fd\u4f1a\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u503c\u5217\u8868\u3002\u6bd4\u5982\u8bf4\uff0c\u7535\u8bdd\u53f7\u7801\u5b57\u6bb5\u6709\u4e2a\u7c7b\u578b\uff0c\u8fd9\u4e2a\u7c7b\u578b\u53ef\u4ee5\u662f\uff0chome,work,mobile\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7enum\u5728\u6d88\u606f\u5b9a\u4e49\u4e2d\u6dfb\u52a0\u6bcf\u4e2a\u53ef\u80fd\u503c\u7684\u5e38\u91cf\u6765\u975e\u5e38\u7b80\u5355\u7684\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u5b9e\u4f8b\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";                      //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\uff0c\u4e0d\u6307\u5b9a\u4f1a\u62a5\u9519\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n//message\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u6d88\u606f\u7c7b\u578b\nmessage Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n    //\u5b9a\u4e49\u4e00\u4e2amessage\n    message PhoneNumber {\n    string number = 1;\n    PhoneType type = 2;\n    }\n    \n    repeated PhoneNumber phone = 3;\n}\n\n//enum\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u679a\u4e3e\u7c7b\u578b\nenum PhoneType {\n    MOBILE = 0;\n    HOME = 1;\n    WORK = 2;\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5982\u4e0a\uff0cenum\u7684\u7b2c\u4e00\u4e2a\u5e38\u91cf\u6620\u5c04\u4e3a0\uff0c\u6bcf\u4e2a\u679a\u4e3e\u5b9a\u4e49",(0,a.kt)("strong",{parentName:"p"},"\u5fc5\u987b"),"\u5305\u542b\u4e00\u4e2a\u6620\u5c04\u5230\u96f6\u7684\u5e38\u91cf\u4f5c\u4e3a\u5176\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u662f\u56e0\u4e3a\uff1a"),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"\u5fc5\u987b\u6709\u4e00\u4e2a\u96f6\u503c\uff0c\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u4f7f\u75280\u4f5c\u4e3a\u6570\u5b57\u9ed8\u8ba4\u503c\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u96f6\u503c\u5fc5\u987b\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u4ee5\u4fbf\u4e0eproto2\u8bed\u4e49\u517c\u5bb9\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u679a\u4e3e\u503c\u59cb\u7ec8\u662f\u9ed8\u8ba4\u503c\u3002"))),(0,a.kt)("p",null,"enum\u8fd8\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684\u679a\u4e3e\u5e38\u91cf\u6307\u5b9a\u76f8\u540c\u7684\u503c\u6765\u5b9a\u4e49\u522b\u540d\u3002\u5982\u679c\u60f3\u8981\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd\u5fc5\u987b\u8bb2",(0,a.kt)("inlineCode",{parentName:"p"},"allow_alias"),"\u9009\u9879\u8bbe\u7f6e\u4e3atrue\uff0c\u8d1f\u8d23\u7f16\u8bd1\u5668\u5c06\u62a5\u9519\u3002\u793a\u4f8b\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";                      //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\uff0c\u4e0d\u6307\u5b9a\u4f1a\u62a5\u9519\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n//message\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u6d88\u606f\u7c7b\u578b\nmessage Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n    //\u5b9a\u4e49\u4e00\u4e2amessage\n    message PhoneNumber {\n        string number = 1;\n        PhoneType type = 2;\n    }\n\n    repeated PhoneNumber phone = 3;\n}\n\n//enum\u4e3a\u5173\u952e\u5b57\uff0c\u4f5c\u7528\u4e3a\u5b9a\u4e49\u4e00\u79cd\u679a\u4e3e\u7c7b\u578b\nenum PhoneType {\n    //\u5982\u679c\u4e0d\u8bbe\u7f6e\u5c06\u62a5\u9519\n    option allow_alias = true;\n    MOBILE = 0;\n    HOME = 1;\n    WORK = 2;\n    Personal = 2;\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"oneof\u5173\u952e\u5b57")),(0,a.kt)("p",null,"\u5982\u679c\u6709\u4e00\u4e2a\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u7684\u6d88\u606f\uff0c\u5e76\u4e14\u6700\u591a\u53ea\u80fd\u540c\u65f6\u8bbe\u7f6e\u5176\u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528oneof\u529f\u80fd\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},"message Person{\n    //    \u540d\u5b57\n    string name = 1;\n    //    \u5e74\u9f84\n    int32  age = 2 ;\n    //\u5b9a\u4e49\u4e00\u4e2amessage\n    message PhoneNumber {\n        string number = 1;\n        PhoneType type = 2;\n    }\n\n    repeated PhoneNumber phone = 3;\n    oneof data{\n        string school = 5;\n        int32 score = 6;\n    }\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5b9a\u4e49RPC\u670d\u52a1")),(0,a.kt)("p",null,"\u5982\u679c\u9700\u8981\u5c06message\u4e0eRPC\u4e00\u8d77\u4f7f\u7528\uff0c\u5219\u53ef\u4ee5\u5728",(0,a.kt)("inlineCode",{parentName:"p"},".proto"),"\u6587\u4ef6\u4e2d\u5b9a\u4e49RPC\u670d\u52a1\u63a5\u53e3\uff0cprotobuf\u7f16\u8bd1\u5668\u5c06\u6839\u636e\u4f60\u9009\u62e9\u7684\u8bed\u8a00\u751f\u6210RPC\u63a5\u53e3\u4ee3\u7801\u3002\u793a\u4f8b\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},"//\u5b9a\u4e49RPC\u670d\u52a1\nservice HelloService {\n    rpc Hello (Person)returns (Person);\n}\n")),(0,a.kt)("p",null,"\u5927\u90e8\u5206protobuf\u7684\u8bed\u6cd5\u5c31\u662f\u8fd9\u6837\uff0c\u5176\u4ed6\u60f3\u5b66\u4e60\u7684\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff0c\u8bed\u6cd5\u5199\u5b8c\u4e4b\u540e\uff0c\u8ba9\u6211\u4eec\u7f16\u8bd1\u4e00\u4e0b\uff0c\u7136\u540e\u901a\u8fc7\u4ee3\u7801\u8bd5\u7528\u4e00\u4e0b\u3002"),(0,a.kt)("h2",{id:"34-protobuf\u57fa\u672c\u7f16\u8bd1"},"3.4 protobuf\u57fa\u672c\u7f16\u8bd1"),(0,a.kt)("p",null,"protobuf\u7f16\u8bd1\u662f\u901a\u8fc7\u7f16\u8bd1\u5668protoc\u8fdb\u884c\u7684\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7f16\u8bd1\u5668\uff0c\u6211\u4eec\u53ef\u4ee5\u628a.proto\u6587\u4ef6\u751f\u6210",(0,a.kt)("strong",{parentName:"p"},"go"),",Java,Python,C++, Ruby, JavaNano, Objective-C,\u6216\u8005C# \u4ee3\u7801\uff0c\u751f\u6210\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"}," protoc --proto_path=IMPORT_PATH --go_out=DST_DIR  path/to/file.proto\n")),(0,a.kt)("blockquote",null,(0,a.kt)("ol",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ol"},"--proto_path=IMPORT_PATH\uff0cIMPORT_PATH\u662f .proto \u6587\u4ef6\u6240\u5728\u7684\u8def\u5f84\uff0c\u5982\u679c\u5ffd\u7565\u5219\u9ed8\u8ba4\u5f53\u524d\u76ee\u5f55\u3002\u5982\u679c\u6709\u591a\u4e2a\u76ee\u5f55\u5219\u53ef\u4ee5\u591a\u6b21\u8c03\u7528--proto_path\uff0c\u5b83\u4eec\u5c06\u4f1a\u987a\u5e8f\u7684\u88ab\u8bbf\u95ee\u5e76\u6267\u884c\u5bfc\u5165\u3002"),(0,a.kt)("li",{parentName:"ol"},"--go_out=DST_DIR\uff0c \u6307\u5b9a\u4e86\u751f\u6210\u7684go\u8bed\u8a00\u4ee3\u7801\u6587\u4ef6\u653e\u5165\u7684\u6587\u4ef6\u5939"),(0,a.kt)("li",{parentName:"ol"},"\u5141\u8bb8\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"protoc --go_out=./   *.proto")," \u7684\u65b9\u5f0f\u4e00\u6b21\u6027\u7f16\u8bd1\u591a\u4e2a .proto \u6587\u4ef6"),(0,a.kt)("li",{parentName:"ol"},"go\u8bed\u8a00\u7f16\u8bd1\u65f6\uff0cprotobuf \u7f16\u8bd1\u5668\u4f1a\u628a .proto \u6587\u4ef6\u7f16\u8bd1\u6210 .pd.go \u6587\u4ef6"))),(0,a.kt)("p",null,"\u4e00\u822c\u5728\u4f7f\u7528\u7684\u65f6\u5019\u6211\u4eec\u90fd\u662f\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u7b80\u5355\u7684\u547d\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"protoc --go_out=./ *.proto\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u7f16\u8bd1\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709.proto\u6587\u4ef6\uff0c\u5e76\u628a\u751f\u6210\u7684go\u6587\u4ef6\u653e\u7f6e\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u3002")),(0,a.kt)("p",null,"\u6211\u4eec\u5148\u6765\u7f16\u8bd1\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u7684proto\u6587\u4ef6\uff0c\u7f16\u8bd1\u4e4b\u540e\u4f1a\u5f97\u5230\u4e00\u4e2a\u5982\u4e0b\u4e00\u4e2ago\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564628074411",src:t(3545).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"message\u88ab\u5bf9\u5e94\u7684\u7f16\u8bd1\u6210go\u8bed\u8a00\u4e2d\u7684\u7ed3\u6784\u4f53\uff0c\u540c\u65f6\u8fd8\u4e3aString\u7c7b\u578b\u81ea\u52a8\u751f\u6210\u4e86\u4e00\u7ec4\u65b9\u6cd5\uff0c\u5176\u4e2dProtoMessage\u65b9\u6cd5\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86proto.Message\u63a5\u53e3\u7684\u65b9\u6cd5\u3002\u6b64\u5916Protobuf\u8fd8\u4e3a\u6bcf\u4e2a\u6210\u5458\u751f\u6210\u4e86\u4e00\u4e2aGet\u65b9\u6cd5\uff0cGet\u65b9\u6cd5\u4e0d\u4ec5\u53ef\u4ee5\u5904\u7406\u7a7a\u6307\u9488\u7c7b\u578b\uff0c\u800c\u4e14\u53ef\u4ee5\u548cProto2\u7684\u65b9\u6cd5\u4fdd\u6301\u4e00\u81f4.")),(0,a.kt)("p",null,"\u7136\u540e\u6211\u4eec\u7ed9\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},".proto"),"\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e00\u4e2aRPC\u670d\u52a1\uff0c\u518d\u6b21\u8fdb\u884c\u7f16\u8bd1\uff0c\u53d1\u73b0\u751f\u6210\u7684go\u6587\u4ef6\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002\u8fd9\u662f\u56e0\u4e3a\u4e16\u754c\u4e0a\u7684RPC\u5b9e\u73b0\u6709\u5f88\u591a\u79cd\uff0cprotoc\u7f16\u8bd1\u5668\u5e76\u4e0d\u77e5\u9053\u8be5\u5982\u4f55\u4e3aHelloService\u670d\u52a1\u751f\u6210\u4ee3\u7801\u3002\u4e0d\u8fc7\u5728protoc-gen-go\u5185\u90e8\u5df2\u7ecf\u96c6\u6210\u4e86\u4e00\u4e2a\u53ebgrpc\u7684\u63d2\u4ef6\uff0c\u53ef\u4ee5\u9488\u5bf9grpc\u751f\u6210\u4ee3\u7801\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"protoc --go_out=plugins=grpc:. *.proto\n")),(0,a.kt)("p",null,"\u5728\u751f\u6210\u7684\u4ee3\u7801\u4e2d\u591a\u4e86\u4e00\u4e9b\u7c7b\u4f3cHelloServiceServer\u3001HelloServiceClient\u7684\u65b0\u7c7b\u578b\u3002\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564652925915",src:t(6155).Z})),(0,a.kt)("p",null,"\u548c\u6211\u4eec\u4f18\u5316\u4e4b\u540e\u7684RPC\u670d\u52a1\u6709\u70b9\u76f8\u4f3c\uff0c\u4f46\u662f\u53c8\u4e0d\u592a\u4e00\u6837\uff0c\u63a5\u4e0b\u6765\u5c31\u8ba9\u6211\u4eec\u6765\u5b66\u4e60\u4e00\u4e0bgrpc\u6846\u67b6\u5427\u3002"),(0,a.kt)("p",null,"\u65b0\u7248\u7f16\u8bd1\u65b9\u6cd5\u5982\u4e0b:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ protoc --go_out=./ *.proto\n$ protoc --go-grpc_out=./ *.proto\n")),(0,a.kt)("h1",{id:"4-grpc\u6846\u67b6"},"4. GRPC\u6846\u67b6"),(0,a.kt)("p",null,"GRPC\u662fGoogle\u516c\u53f8\u57fa\u4e8e",(0,a.kt)("strong",{parentName:"p"},"Protobuf"),"\u5f00\u53d1\u7684\u8de8\u8bed\u8a00\u7684",(0,a.kt)("strong",{parentName:"p"},"\u5f00\u6e90RPC\u6846\u67b6"),"\u3002GRPC\u57fa\u4e8e",(0,a.kt)("strong",{parentName:"p"},"HTTP/2"),"\u534f\u8bae\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u57fa\u4e8e\u4e00\u4e2aHTTP/2\u94fe\u63a5\u63d0\u4f9b\u591a\u4e2a\u670d\u52a1\uff0c\u5bf9\u4e8e\u79fb\u52a8\u8bbe\u5907\u66f4\u52a0\u53cb\u597d\u3002\u76ee\u524d\u63d0\u4f9b C\u3001Java \u548c Go \u8bed\u8a00\u7248\u672c\uff0c\u5206\u522b\u662f\uff1agrpc, grpc-java, grpc-go. \u5176\u4e2d C \u7248\u672c\u652f\u6301 C, C++, Node.js, Python, Ruby, Objective-C, PHP \u548c C# \u652f\u6301."),(0,a.kt)("p",null,"\u5728 gRPC\u91cc\u5ba2\u6237\u7aef\u5e94\u7528\u53ef\u4ee5\u50cf\u8c03\u7528\u672c\u5730\u5bf9\u8c61\u4e00\u6837\u76f4\u63a5\u8c03\u7528\u53e6\u4e00\u53f0\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u670d\u52a1\u7aef\u5e94\u7528\u7684\u65b9\u6cd5\uff0c\u4f7f\u5f97\u60a8\u80fd\u591f\u66f4\u5bb9\u6613\u5730\u521b\u5efa\u5206\u5e03\u5f0f\u5e94\u7528\u548c\u670d\u52a1\u3002\u4e0e\u8bb8\u591a RPC\u7cfb\u7edf\u7c7b\u4f3c\uff0c gRPC\u4e5f\u662f\u57fa\u4e8e\u4ee5\u4e0b\u7406\u5ff5\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\uff0c\u6307\u5b9a\u5176\u80fd\u591f\u88ab\u8fdc\u7a0b\u8c03\u7528\u7684\u65b9\u6cd5\uff08\u5305\u542b\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\uff09\u3002")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u5728\u670d\u52a1\u7aef\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\uff0c\u5e76\u8fd0\u884c\u4e00\u4e2a gRPC\u670d\u52a1\u5668\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8c03\u7528\u3002"))),(0,a.kt)("p",null,"\u5728\u5ba2\u6237\u7aef\u62e5\u6709\u4e00\u4e2a\u5b58\u6839\u80fd\u591f\u50cf\u670d\u52a1\u7aef\u4e00\u6837\u7684\u65b9\u6cd5\u3002 gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u591a\u79cd\u73af\u5883\u4e2d\u8fd0\u884c\u548c\u4ea4\u4e92 -\u4ece google\u5185\u90e8\u7684\u670d\u52a1\u5668\u5230\u4f60\u81ea\u5df1\u7684\u7b14\u8bb0\u672c\uff0c\u5e76\u4e14\u53ef\u4ee5\u7528\u4efb\u4f55 gRPC\u652f\u6301\u7684\u8bed\u8a00 \u6765\u7f16\u5199\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\uff0c\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u7528 Java\u521b\u5efa\u4e00\u4e2a gRPC\u670d\u52a1\u7aef\uff0c\u7528 Go\u3001 Python\u3001Ruby\u6765\u521b\u5efa\u5ba2\u6237\u7aef\u3002\u6b64\u5916\uff0c Google\u6700\u65b0 API\u5c06\u6709 gRPC\u7248\u672c\u7684\u63a5\u53e3\uff0c\u4f7f\u4f60\u5f88\u5bb9\u6613\u5730\u5c06 Google\u7684\u529f\u80fd\u96c6\u6210\u5230\u4f60\u7684\u5e94\u7528\u91cc\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u53c2\u8003\u8d44\u6599")),(0,a.kt)("p",null,"gRPC \u5b98\u65b9\u6587\u6863\u4e2d\u6587\u7248:",(0,a.kt)("a",{parentName:"p",href:"http://doc.oschina.net/grpc?t=60133"},"http://doc.oschina.net/grpc?t=60133")),(0,a.kt)("p",null,"gRPC\u5b98\u7f51\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://grpc.io/"},"https://grpc.io")),(0,a.kt)("p",null,"\u518d\u8be6\u7ec6\u4e86\u89e3\u4f7f\u7528GRPC\u4e4b\u524d\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u4e0a\u9762\u5b9a\u4e49\u4e2d\u7684\u4e00\u4e9b\u5173\u952e\u8bcd\u3002"),(0,a.kt)("p",null,"\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e0b",(0,a.kt)("strong",{parentName:"p"},"HTTP/2"),"\u662f\u4ec0\u4e48\u5185\u5bb9\uff1f"),(0,a.kt)("p",null,"\u5176\u5b9e\u672c\u8d28\u4e0a\u5c31\u662fhttp2.0\u7248\u672c\uff0chttp\u76ee\u524d\u4e3a\u6b62\u4e3b\u8981\u6709\u56db\u4e2a\u7248\u672c\uff0c\u5206\u522b\u4e3ahttp1.0\u3001http1.1\u3001http2.0\u3001https\u3002"),(0,a.kt)("p",null,"http1.0\u662f\u6700\u539f\u59cb\u7684\u7248\u672c\uff0c\u4e0d\u652f\u6301\u6301\u4e45\u8fde\u63a5\uff0c\u6548\u7387\u4e5f\u6bd4\u8f83\u4f4e"),(0,a.kt)("p",null,"http1.1\u9488\u5bf9http1.0\u7248\u672c\u505a\u4e86\u4f18\u5316\uff0c\u53ef\u4ee5\u8fde\u63a5\u4e00\u6b21\uff0c\u591a\u6b21\u4f7f\u7528\uff0c\u6548\u7387\u6bd4http1.0\u9ad8"),(0,a.kt)("p",null,"http2.0\u5b9e\u73b0\u4e86\u591a\u8def\u590d\u7528\uff0c\u5bf9http1.1\u518d\u6b21\u8fdb\u884c\u4e86\u4f18\u5316\u3002http2.0\u4e5f\u88ab\u79f0\u4e3a\u4e0b\u4e00\u4ee3http\u534f\u8bae\uff0c\u662f\u57282013\u5e748\u6708\u8fdb\u884c\u9996\u6b21\u6d4b\u8bd5\uff0c\u6240\u4ee5\u73b0\u5728\u7528\u7684\u4e0d\u662f\u5f88\u5e7f\u3002"),(0,a.kt)("p",null,"https\u5176\u5b9e\u662f\u5728http\u534f\u8bae\u4e0a\u591a\u52a0\u4e86\u4e00\u5c42SSL\u534f\u8bae\uff0c\u5177\u4f53\u5982\u4e0b\u56fe\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1564539159120",src:t(3957).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6240\u4ee5\u672c\u8d28\u4e0a\uff0chttp1.0\u3001http1.1\u3001http2.0\u90fd\u53ef\u4ee5\u6dfb\u52a0SSL\u534f\u8bae\u3002")),(0,a.kt)("h2",{id:"41-grpc\u73af\u5883\u5b89\u88c5"},"4.1 grpc\u73af\u5883\u5b89\u88c5"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5b98\u65b9\u63a8\u8350\u5b89\u88c5\u65b9\u6cd5\uff1a"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"go get -u -v google.golang.org/grpc\n")),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"\u4f46\u662f\u7531\u4e8e\u4e00\u4e9b\u539f\u56e0\uff0c\u5927\u90e8\u5206\u540c\u5b66\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95eegoogle\u5b98\u7f51\uff0c\u6240\u4ee5\u53ea\u80fd\u66f2\u7ebf\u6551\u56fd\u4e86"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u901a\u8fc7github\u4e0b\u8f7d\u5404\u79cd\u4f9d\u8d56\u5e93\uff0c\u7136\u540e\u914d\u7f6e\u3002"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/grpc/grpc-go.git      $GOPATH/src/google.golang.org/grpc\ngit clone https://github.com/golang/net.git        $GOPATH/src/golang.org/x/net\ngit clone https://github.com/golang/text.git       $GOPATH/src/golang.org/x/text\ngit clone https://github.com/google/go-genproto.git  $GOPATH/src/google.golang.org/genproto\n\ncd $GOPATH/src/\ngo install google.golang.org/grpc\n")),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"\u7f51\u7edc\u7545\u901a\u53ef\u4ee5\u7528\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u4f46\u5982\u679c\u7f51\u901f\u8f83\u6162\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u79bb\u7ebf\u5b89\u88c5\u65b9\u6cd5\u3002"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"x.zip"),"\u548c",(0,a.kt)("inlineCode",{parentName:"p"},"google.golang.org.zip"),"\u4e24\u4e2a\u79bb\u7ebf\u5305\u6765\u5b89\u88c5\u3002"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"#\u5c06x.zip \u89e3\u538b\u5230 $GOPATH/src/golang.org/x \u76ee\u5f55\u4e0b\n$ unzip x.zip -d $GOPATH/src/golang.org/x\n#\u5c06google.golang.org.zip \u89e3\u538b\u5230 $GOPATH/src/google.golang.org \u76ee\u5f55\u4e0b\n$ unzip google.golang.org.zip -d $GOPATH/src/google.golang.org\n#\u7136\u540e\u8fdb\u5165\u5230$GOPATH/src/google.golang.org/grpc\u4e0b\u9762\u6267\u884cgo install\n$ go install\n")))),(0,a.kt)("h2",{id:"42-grpc\u4f7f\u7528"},"4.2 GRPC\u4f7f\u7528"),(0,a.kt)("p",null,"   \t\u5982\u679c\u4eceProtobuf\u7684\u89d2\u5ea6\u770b\uff0cGRPC\u53ea\u4e0d\u8fc7\u662f\u4e00\u4e2a\u9488\u5bf9service\u63a5\u53e3\u751f\u6210\u4ee3\u7801\u7684\u751f\u6210\u5668\u3002\u63a5\u7740\u6211\u4eec\u6765\u5b66\u4e60\u4e00\u4e0bGRPC\u7684\u7528\u6cd5\u3002\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684proto\u6587\u4ef6\uff0c\u5b9a\u4e49\u4e00\u4e2aHelloService\u63a5\u53e3\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";              //\u6307\u5b9a\u7248\u672c\u4fe1\u606f\npackage pb;                     //\u540e\u671f\u751f\u6210go\u6587\u4ef6\u7684\u5305\u540d\n\nmessage Person{\n    //   \u540d\u5b57\n    string name = 1;\n    //   \u5e74\u9f84\n    int32  age = 2 ;\n}\n\n//\u5b9a\u4e49RPC\u670d\u52a1\nservice HelloService {\n    rpc Hello (Person)returns (Person);\n}\n')),(0,a.kt)("p",null,"\u5bf9proto\u6587\u4ef6\u8fdb\u884c\u7f16\u8bd1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ protoc --go_out=plugins=grpc:. *.proto\n$ protoc --go-grpc_out=./ *.proto   (\u65b0\u7248\u7f16\u8bd1)\n")),(0,a.kt)("p",null,"GRPC\u63d2\u4ef6\u4f1a\u4e3a\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u751f\u6210\u4e0d\u540c\u7684\u63a5\u53e3\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"//\u5ba2\u6237\u7aef\u63a5\u53e3\ntype HelloServiceClient interface {\n    Hello(ctx context.Context, in *Person, opts ...grpc.CallOption) (*Person, error)\n}\n//\u670d\u52a1\u5668\u63a5\u53e3\ntype HelloServiceServer interface {\n    Hello(context.Context, *Person) (*Person, error)\n}\n")),(0,a.kt)("p",null,"\u6211\u4eec\u63a5\u7740\u53ef\u4ee5\u57fa\u4e8e\u4ed6\u4eec\u7ed9\u7684\u670d\u52a1\u7aef\u63a5\u53e3\u91cd\u65b0\u5b9e\u73b0HelloService\u670d\u52a1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'type HelloService struct{}\n\nfunc (this*HelloService)Hello(ctx context.Context, person *pb.Person) (*pb.Person, error){\n    reply := &pb.Person{\n        Name:"zhangsan" + person.Name,\n        Age:18,\n    }\n\n    return reply,nil\n}\n')),(0,a.kt)("p",null,"GRPC\u7684\u542f\u52a8\u6d41\u7a0b\u548cRPC\u7684\u542f\u52a8\u6d41\u7a0b\u7c7b\u4f3c\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u83b7\u53d6grpc\u670d\u52a1\u7aef\u5bf9\u8c61\n    grpcServer := grpc.NewServer()\n    //\u6ce8\u518cgrpc\u670d\u52a1\n    pb.RegisterHelloServiceServer(grpcServer,new(HelloService))\n\n    //\u8bbe\u7f6e\u670d\u52a1\u7aef\u76d1\u542c\n    lis,err := net.Listen("tcp",":1234")\n    if err != nil {\n        panic(err)\n    }\n\n    //\u5728\u6307\u5b9a\u7aef\u53e3\u4e0a\u63d0\u4f9bgrpc\u670d\u52a1\n    grpcServer.Serve(lis)\n}\n')),(0,a.kt)("p",null,"\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u5ba2\u6237\u7aef\u6765\u8fde\u63a5GRPC\u670d\u52a1\u4e86\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u548cgrpc\u670d\u52a1\u5efa\u7acb\u8fde\u63a5\n    conn,err := grpc.Dial("localhost:1234",grpc.WithInsecure())\n    if err != nil {\n        panic(err)\n    }\n\n    defer conn.Close()\n\n    client := pb.NewHelloServiceClient(conn)\n    reply,err := client.Hello(context.Background(),&pb.Person{Name:"lisi",Age:100})\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println("reply,",reply)\n}\n')),(0,a.kt)("h1",{id:"5-go-micro\u6846\u67b6"},"5. go-micro\u6846\u67b6"),(0,a.kt)("p",null,"\u5728\u4e86\u89e3go-micro\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u4ec0\u4e48\u662fmicro\u3002"),(0,a.kt)("p",null,"Micro\u662f\u4e00\u4e2a\u4e13\u6ce8\u4e8e\u7b80\u5316\u5206\u5e03\u5f0f\u7cfb\u7edf\u5f00\u53d1\u7684\u5fae\u670d\u52a1\u751f\u6001\u7cfb\u7edf\u3002\u7531\u5f00\u6e90\u5e93\u548c\u5de5\u5177\u7ec4\u6210\u3002\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u79cd\u5e93\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"go-micro\uff1a"),"\u7528\u4e8e\u7f16\u5199\u5fae\u670d\u52a1\u7684\u53ef\u63d2\u5165Go-RPC\u6846\u67b6;\t",(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u53d1\u73b0"),"\uff0c\u5ba2\u6237\u7aef/\u670d\u52a1\u5668rpc\uff0cpub/sub\u7b49\uff0c\u662f\u6574\u4e2aMicro\u7684\u6838\u5fc3\u3002"),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"\u9ed8\u8ba4\u4f7f\u7528mdns\u505a\u670d\u52a1\u53d1\u73b0\uff0c\u53ef\u4ee5\u5728\u63d2\u4ef6\u4e2d\u66ff\u6362\u6210consul,etcd,k8s\u7b49"),(0,a.kt)("p",{parentName:"blockquote"},"\u7ec4\u64ad   \u5e7f\u64ad"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"go-plugins\uff1a"),"go-micro\u7684\u63d2\u4ef6\uff0c\u5305\u62ecetcd\uff0ckubernetes(k8s)\uff0cnats\uff0crabbitmq\uff0cgrpc\u7b49 ")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"micro\uff1a"),"\u4e00\u4e2a\u5305\u542b\u4f20\u7edf\u5165\u53e3\u70b9\u7684\u5fae\u670d\u52a1\u5de5\u5177\u5305;\tAPI\u7f51\u5173\uff0cCLI\uff0cSlack\tBot\uff0cSidecar\u548cWeb\tUI\u3002"))),(0,a.kt)("p",null,"\u5176\u4ed6\u5404\u79cd\u5e93\u548c\u670d\u52a1\u53ef\u4ee5\u5728",(0,a.kt)("strong",{parentName:"p"},"github.com/micro"),"\u627e\u5230\u3002"),(0,a.kt)("p",null,"\u6211\u4eec\u4e3b\u8981\u4f7f\u7528\u7684\u6846\u67b6\u4e5f\u662fgo-micro\uff0c\u5728\u4f7f\u7528\u4e4b\u524d\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e0b",(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u53d1\u73b0"),"\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\uff1f\u6709\u4ec0\u4e48\u4f5c\u7528\uff1f"),(0,a.kt)("h2",{id:"51-\u670d\u52a1\u53d1\u73b0"},"5.1 \u670d\u52a1\u53d1\u73b0"),(0,a.kt)("p",null,"\u6211\u4eec\u5728\u505a\u5fae\u670d\u52a1\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u7684\u4e00\u4e2a\u63a5\u53e3\u53ef\u80fd\u9700\u8981\u8c03\u7528N\u4e2a\u670d\u52a1\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u77e5\u9053\u6240\u6709\u670d\u52a1\u7684\u7f51\u7edc\u4f4d\u7f6e\uff08ip+port\uff09\uff0c\u5982\u4e0b\u56fe\u6240\u793a"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(7404).Z})),(0,a.kt)("p",null,"\u4ee5\u5f80\u7684\u505a\u6cd5\u662f\u628a\u670d\u52a1\u7684\u5730\u5740\u653e\u5728\u914d\u7f6e\u6587\u4ef6\u6d3b\u6570\u636e\u5e93\u4e2d\uff0c\u8fd9\u6837\u5c31\u6709\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u9700\u8981\u914d\u7f6eN\u4e2a\u670d\u52a1\u7684\u7f51\u7edc\u4f4d\u7f6e\uff0c\u52a0\u5927\u914d\u7f6e\u7684\u590d\u6742\u6027"),(0,a.kt)("li",{parentName:"ul"},"\u670d\u52a1\u7684\u7f51\u7edc\u4f4d\u7f6e\u53d8\u5316\uff0c\u9700\u8981\u6539\u53d8\u6bcf\u4e2a\u8c03\u7528\u8005\u7684\u914d\u7f6e"),(0,a.kt)("li",{parentName:"ul"},"\u96c6\u7fa4\u7684\u60c5\u51b5\u4e0b\uff0c\u96be\u4ee5\u505a\u8d1f\u8f7d\uff08\u53cd\u5411\u4ee3\u7406\u7684\u65b9\u5f0f\u9664\u5916\uff09")),(0,a.kt)("p",null,"\u603b\u7ed3\u8d77\u6765\u4e00\u53e5\u8bdd\uff1a",(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u591a\u4e86\uff0c\u914d\u7f6e\u5f88\u9ebb\u70e6\uff0c\u95ee\u9898\u4e00\u5927\u5806")),(0,a.kt)("p",null,"\u6240\u4ee5\u73b0\u5728\u5c31\u9009\u62e9",(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u53d1\u73b0"),"\u6765\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u670d\u52a1\u53d1\u73b0\u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5177\u4f53\u8bbe\u8ba1\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(6739).Z})),(0,a.kt)("p",null,"\u4e0e\u4e4b\u524d\u89e3\u51b3\u65b9\u6cd5\u4e0d\u540c\u7684\u662f\uff0c\u52a0\u4e86\u4e2a\u670d\u52a1\u53d1\u73b0\u6a21\u5757\u3002\u670d\u52a1\u7aef\u628a\u5f53\u524d\u81ea\u5df1\u7684\u7f51\u7edc\u4f4d\u7f6e\u6ce8\u518c\u5230\u670d\u52a1\u53d1\u73b0\u6a21\u5757\uff08\u8fd9\u91cc\u6ce8\u518c\u7684\u610f\u601d\u5c31\u662f\u544a\u8bc9\uff09\uff0c\u670d\u52a1\u53d1\u73b0\u5c31\u4ee5K-V\u7684\u65b9\u5f0f\u8bb0\u5f55\u4e0b\uff0cK\u4e00\u822c\u662f\u670d\u52a1\u540d\uff0cV\u5c31\u662fIP:PORT\u3002\u670d\u52a1\u53d1\u73b0\u6a21\u5757\u5b9a\u65f6\u7684\u8f6e\u8be2\u67e5\u770b\u8fd9\u4e9b\u670d\u52a1\u80fd\u4e0d\u80fd\u8bbf\u95ee\u7684\u4e86\uff08\u8fd9\u5c31\u662f\u5065\u5eb7\u68c0\u67e5\uff09\u3002\u5ba2\u6237\u7aef\u5728\u8c03\u7528\u670d\u52a1A-N\u7684\u65f6\u5019\uff0c\u5c31\u8dd1\u53bb\u670d\u52a1\u53d1\u73b0\u6a21\u5757\u95ee\u4e0b\u5b83\u4eec\u7684\u7f51\u7edc\u4f4d\u7f6e\uff0c\u7136\u540e\u518d\u8c03\u7528\u5b83\u4eec\u7684\u670d\u52a1\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u662f\u4e0d\u662f\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\u4e86\u5462\uff1f\u5ba2\u6237\u7aef\u5b8c\u5168\u4e0d\u9700\u8981\u8bb0\u5f55\u8fd9\u4e9b\u670d\u52a1\u7684\u7f51\u7edc\u4f4d\u7f6e\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5b8c\u5168\u89e3\u8026\uff01"),(0,a.kt)("p",null,"\u5e38\u89c1\u7684\u670d\u52a1\u53d1\u73b0\u6846\u67b6\u6709\uff1aEtcd\u3001Eureka\u3001",(0,a.kt)("strong",{parentName:"p"},"Consul"),"\u3001Zookeeper"),(0,a.kt)("p",null,"\u8fd9\u91cc\u6211\u4eec\u9009\u62e9go-micro\u9ed8\u8ba4\u7684\u670d\u52a1\u53d1\u73b0\u6846\u67b6consul\u6765\u505a\u4e00\u4e2a\u8be6\u7ec6\u4ecb\u7ecd\u3002"),(0,a.kt)("h2",{id:"52-\u4e86\u89e3consul\u5e76\u4f7f\u7528"},"5.2 \u4e86\u89e3consul\u5e76\u4f7f\u7528"),(0,a.kt)("p",null,"Consul\u662fHashiCorp\u516c\u53f8\u63a8\u51fa\u7684\u5f00\u6e90\u5de5\u5177\uff0c\u7528\u4e8e\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u3002\u5305\u542b\u591a\u4e2a\u7ec4\u4ef6,\u4f46\u662f\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53,\u4e3a\u4f60\u7684\u57fa\u7840\u8bbe\u65bd\u63d0\u4f9b\u670d\u52a1\u53d1\u73b0\u548c\u670d\u52a1\u914d\u7f6e\u7684\u5de5\u5177.\u4ed6\u63d0\u4f9b\u4ee5\u4e0b\u5173\u952e\u7279\u6027:"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u53d1\u73b0"),"\uff1aconsul\u901a\u8fc7DNS\u6216\u8005HTTP\u63a5\u53e3\u4f7f\u670d\u52a1\u6ce8\u518c\u548c\u670d\u52a1\u53d1\u73b0\u53d8\u7684\u5f88\u5bb9\u6613\uff0c\u4e00\u4e9b\u5916\u90e8\u670d\u52a1\uff0c\u4f8b\u5982saas\u63d0\u4f9b\u7684\u4e5f\u53ef\u4ee5\u4e00\u6837\u6ce8\u518c\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5065\u5eb7\u68c0\u67e5"),"\uff1a\u5065\u5eb7\u68c0\u6d4b\u4f7fconsul\u53ef\u4ee5\u5feb\u901f\u7684\u544a\u8b66\u5728\u96c6\u7fa4\u4e2d\u7684\u64cd\u4f5c\u3002\u548c\u670d\u52a1\u53d1\u73b0\u7684\u96c6\u6210\uff0c\u53ef\u4ee5\u9632\u6b62\u670d\u52a1\u8f6c\u53d1\u5230\u6545\u969c\u7684\u670d\u52a1\u4e0a\u9762\u3002(\u5fc3\u8df3\u673a\u5236)"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u952e/\u503c\u5b58\u50a8"),"\uff1a\u4e00\u4e2a\u7528\u6765\u5b58\u50a8\u52a8\u6001\u914d\u7f6e\u7684\u7cfb\u7edf\u3002\u63d0\u4f9b\u7b80\u5355\u7684HTTP\u63a5\u53e3\uff0c\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u64cd\u4f5c\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u591a\u6570\u636e\u4e2d\u5fc3"),"\uff1a\u65e0\u9700\u590d\u6742\u7684\u914d\u7f6e\uff0c\u5373\u53ef\u652f\u6301\u4efb\u610f\u6570\u91cf\u7684\u533a\u57df\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5b98\u65b9\u5efa\u8bae\uff1a\u6700\u597d\u662f\u4e09\u53f0\u6216\u8005\u4e09\u53f0\u4ee5\u4e0a\u7684consul\u5728\u8fd0\u884c\uff0c\u540c\u540d\u670d\u52a1\u6700\u597d\u662f\u4e09\u53f0\u6216\u4e09\u53f0\u4ee5\u4e0a\uff0c\u9ed8\u8ba4\u53ef\u4ee5\u642d\u5efa\u96c6\u7fa4")),(0,a.kt)("h3",{id:"521-consul\u5b89\u88c5"},"5.2.1 consul\u5b89\u88c5"),(0,a.kt)("p",null,"\u200b\tConsul\u7528Golang\u5b9e\u73b0\uff0c\u56e0\u6b64\u5177\u6709\u5929\u7136\u53ef\u79fb\u690d\u6027 (\u652f\u6301 Linux\u3001windows\u548cmacOS)\u3002\u5b89\u88c5\u5305\u4ec5\u5305\u542b\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u3002 Consul\u5b89\u88c5\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u4e0b\u8f7d\u5bf9\u5e94\u7cfb\u7edf\u7684\u8f6f\u4ef6\u5305\u5e76\u89e3\u538b\u540e\u5c31\u53ef\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u5b89\u88c5\u6b65\u9aa4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# \u8fd9\u91cc\u4ee5 ubuntu\u7cfb\u7edf\u4e3a\u4f8b\uff1a\n$ wget https://releases.hashicorp.com/consul/1.5.2/consul_1.5.2_linux_amd64.zip\n$ unzip consul_1.5.2_linux_amd64.zip\n$ sudo mv consul /usr/local/bin/\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6559\u5ba4\u7f51\u901f\u539f\u56e0\uff0c\u7528\u8001\u5e08\u7ed9\u7684\u79bb\u7ebf\u5305\u89e3\u538b\u5373\u53ef"),(0,a.kt)("p",{parentName:"blockquote"},"\u5176\u4ed6\u7cfb\u7edf\u7248\u672c\u53ef\u4ee5\u5728\u8fd9\u91cc\u4e0b\u8f7d\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://www.consul.io/downloads.html"},"https://www.consul.io/downloads.html"))),(0,a.kt)("p",null,"\u5b89\u88c5\u9a8c\u8bc1\uff1a"),(0,a.kt)("p",null,"\u5b89\u88c5 Consul\u540e\uff0c\u901a\u8fc7\u6267\u884c consul\u547d\u4ee4\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u547d\u4ee4\u5217\u8868\u7684\u8f93\u51fa"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(3606).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u6ca1\u6709\u62a5\u9519\u5c31\u6210\u529f\u4e86")),(0,a.kt)("h3",{id:"522-consul\u7684\u547d\u4ee4\u884c"},"5.2.2 consul\u7684\u547d\u4ee4\u884c"),(0,a.kt)("p",null,"consul\u5b89\u88c5\u597d\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u4f7f\u7528\u4e00\u4e0b\u5427\u3002\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e0bconsul\u90fd\u6709\u54ea\u4e9b\u547d\u4ee4\u3002\u4f7f\u7528\u547d\u4ee4",(0,a.kt)("inlineCode",{parentName:"p"},"consul -h"),"\u53ef\u4ee5\u67e5\u770bconsul\u652f\u6301\u7684\u6240\u6709\u53c2\u6570\uff0c\u800c\u4e14\u6bcf\u4e2a\u53c2\u6570\u91cc\u9762\u8fd8\u652f\u6301\u5176\u4ed6\u53c2\u6570\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u5177\u4f53\u770b\u770b\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"agent\uff1a"),"\u6307\u4ee4\u662fconsul\u7684\u6838\u5fc3\uff0c\u5b83\u8fd0\u884cagent\u6765\u7ef4\u62a4\u6210\u5458\u7684\u91cd\u8981\u4fe1\u606f\u3001\u8fd0\u884c\u68c0\u67e5\u3001\u670d\u52a1\u5ba3\u5e03\u3001\u67e5\u8be2\u5904\u7406\u7b49\u7b49\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"==> Usage: consul agent [options]\n  Starts the Consul agent and runs until an interrupt is received. The\n  agent represents a single node in a cluster.\nOptions:\n  -advertise=addr                  Sets the advertise address to use\n  -advertise-wan=addr              Sets address to advertise on wan instead of\n                                   advertise addr\n  -bootstrap                       Sets server to bootstrap mode\n  -bind=0.0.0.0                    Sets the bind address for cluster\n                                   communication\n  -http-port=8500                  Sets the HTTP API port to listen on\n  -bootstrap-expect=0              Sets server to expect bootstrap mode.\n  -client=127.0.0.1                Sets the address to bind for client access.\n                                   This includes RPC, DNS, HTTP and HTTPS (if\n                                   configured)\n  -config-file=foo                 Path to a JSON file to read configuration\n                                   from. This can be specified multiple times.\n  -config-dir=foo                  Path to a directory to read configuration\n                                   files from. This will read every file ending\n                                   in \".json\" as configuration in this\n                                   directory in alphabetical order. This can be\n                                   specified multiple times.\n  -data-dir=path                   Path to a data directory to store agent\n                                   state\n  -dev                             Starts the agent in development mode.\n  -recursor=1.2.3.4                Address of an upstream DNS server.\n                                   Can be specified multiple times.\n  -dc=east-aws                     Datacenter of the agent (deprecated: use\n                                   'datacenter' instead).\n  -datacenter=east-aws             Datacenter of the agent.\n  -encrypt=key                     Provides the gossip encryption key\n  -join=1.2.3.4                    Address of an agent to join at start time.\n                                   Can be specified multiple times.\n  -join-wan=1.2.3.4                Address of an agent to join -wan at start\n                                   time. Can be specified multiple times.\n  -retry-join=1.2.3.4              Address of an agent to join at start time\n                                   with retries enabled. Can be specified\n                                   multiple times.\n  -retry-interval=30s              Time to wait between join attempts.\n  -retry-max=0                     Maximum number of join attempts. Defaults to\n                                   0, which will retry indefinitely.\n  -retry-join-ec2-region           EC2 Region to use for discovering servers to\n                                   join.\n  -retry-join-ec2-tag-key          EC2 tag key to filter on for server\n                                   discovery\n  -retry-join-ec2-tag-value        EC2 tag value to filter on for server\n                                   discovery\n  -retry-join-gce-project-name     Google Compute Engine project to discover\n                                   servers in\n  -retry-join-gce-zone-pattern     Google Compute Engine region or zone to\n                                   discover servers in (regex pattern)\n  -retry-join-gce-tag-value        Google Compute Engine tag value to filter\n                                   for server discovery\n  -retry-join-gce-credentials-file Path to credentials JSON file to use with\n                                   Google Compute Engine\n  -retry-join-wan=1.2.3.4          Address of an agent to join -wan at start\n                                   time with retries enabled. Can be specified\n                                   multiple times.\n  -retry-interval-wan=30s          Time to wait between join -wan attempts.\n  -retry-max-wan=0                 Maximum number of join -wan attempts.\n                                   Defaults to 0, which will retry\n                                   indefinitely.\n  -log-level=info                  Log level of the agent.\n  -node=hostname                   Name of this node. Must be unique in the\n                                   cluster\n  -node-meta=key:value             An arbitrary metadata key/value pair for\n                                   this node.\n                                   This can be specified multiple times.\n  -protocol=N                      Sets the protocol version. Defaults to\n                                   latest.\n  -rejoin                          Ignores a previous leave and attempts to\n                                   rejoin the cluster.\n  -server                          Switches agent to server mode.\n  -syslog                          Enables logging to syslog\n  -ui                              Enables the built-in static web UI server\n  -ui-dir=path                     Path to directory containing the Web UI\n                                   resources\n  -pid-file=path                   Path to file to store agent PID\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"info\uff1a"),"\u6307\u4ee4\u63d0\u4f9b\u4e86\u5404\u79cd\u64cd\u4f5c\u65f6\u53ef\u4ee5\u7528\u5230\u7684debug\u4fe1\u606f\uff0c\u5bf9\u4e8eclient\u548cserver\uff0cinfo\u6709\u8fd4\u56de\u4e0d\u540c\u7684\u5b50\u7cfb\u7edf\u4fe1\u606f\uff0c\u76ee\u524d\u6709\u4ee5\u4e0b\u51e0\u4e2aKV\u4fe1\u606f\uff1aagent(\u63d0\u4f9bagent\u4fe1\u606f)\uff0cconsul(\u63d0\u4f9bconsul\u5e93\u7684\u4fe1\u606f)\uff0craft(\u63d0\u4f9braft\u5e93\u7684\u4fe1\u606f)\uff0cserf_lan(\u63d0\u4f9bLAN gossip pool),serf_wan(\u63d0\u4f9bWAN gossip pool)"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"leave\uff1a"),"\u6307\u4ee4\u89e6\u53d1\u4e00\u4e2a\u4f18\u96c5\u7684\u79bb\u5f00\u52a8\u4f5c\u5e76\u5173\u95edagent\uff0c\u8282\u70b9\u79bb\u5f00\u540e\u4e0d\u4f1a\u5c1d\u8bd5\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\u4e2d\u3002\u8fd0\u884c\u5728server\u72b6\u6001\u7684\u8282\u70b9\uff0c\u8282\u70b9\u4f1a\u88ab\u4f18\u96c5\u7684\u5220\u9664\uff0c\u8fd9\u662f\u5f88\u4e25\u91cd\u7684\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u4e00\u4e2a\u4e0d\u4f18\u96c5\u7684\u79bb\u5f00\u4f1a\u5f71\u54cd\u5230\u96c6\u7fa4\u7684\u53ef\u7528\u6027\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"members\uff1a"),"\u6307\u4ee4\u8f93\u51faconsul agent\u76ee\u524d\u6240\u77e5\u9053\u7684\u6240\u6709\u7684\u6210\u5458\u4ee5\u53ca\u5b83\u4eec\u7684\u72b6\u6001\uff0c\u8282\u70b9\u7684\u72b6\u6001\u53ea\u6709alive\u3001left\u3001failed\u4e09\u79cd\u72b6\u6001\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"-detailed\uff1a\u8f93\u51fa\u6bcf\u4e2a\u8282\u70b9\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\u3002\n-rpc-addr\uff1a\u4e00\u4e2arpc\u5730\u5740\uff0cagent\u53ef\u4ee5\u94fe\u63a5\u4e0a\u6765\u53d1\u9001\u547d\u4ee4\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\uff0c\u9ed8\u8ba4\u662f127.0.0.1:8400\u3002\n-status\uff1a\u8fc7\u6ee4\u51fa\u7b26\u5408\u6b63\u5219\u89c4\u5219\u7684\u8282\u70b9")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"reload\uff1a"),"\u6307\u4ee4\u53ef\u4ee5\u91cd\u65b0\u52a0\u8f7dagent\u7684\u914d\u7f6e\u6587\u4ef6\u3002SIGHUP\u6307\u4ee4\u5728\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u65f6\u4f7f\u7528\uff0c\u4efb\u4f55\u91cd\u65b0\u52a0\u8f7d\u7684\u9519\u8bef\u90fd\u4f1a\u5199\u5728agent\u7684log\u6587\u4ef6\u4e2d\uff0c\u5e76\u4e0d\u4f1a\u6253\u5370\u5230\u5c4f\u5e55\u3002"),(0,a.kt)("h3",{id:"523-consul\u7b80\u5355\u4f7f\u7528"},"5.2.3 consul\u7b80\u5355\u4f7f\u7528"),(0,a.kt)("p",null,"\u9996\u5148\u6211\u4eec\u8981\u8fd0\u884cconsul\uff0c\u8fd0\u884c\u6709\u4e24\u79cd\u6a21\u5f0f\uff0c\u5206\u522b\u662f==server==\u548c==client==\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u5f00\u542f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"consul agent -server\n\nconsul agent \n\n")),(0,a.kt)("p",null,"\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u81f3\u5c11\u5fc5\u987b\u62e5\u6709\u4e00\u4e2aserver\u3002\u4e00\u4e2aclient\u662f\u4e00\u4e2a\u975e\u5e38\u8f7b\u91cf\u7ea7\u7684\u8fdb\u7a0b.\u7528\u4e8e\u6ce8\u518c\u670d\u52a1,\u8fd0\u884c\u5065\u5eb7\u68c0\u67e5\u548c\u8f6c\u53d1\u5bf9server\u7684\u67e5\u8be2.agent\u5fc5\u987b\u5728\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u4e3b\u673a\u4e0a\u8fd0\u884c."),(0,a.kt)("p",null,"\u63a5\u7740\u6211\u4eec\u4ee5server\u7684\u6a21\u5f0f\u542f\u52a8\u4e00\u4e2aconsul\uff1a"),(0,a.kt)("h4",{id:"server\u6a21\u5f0f\u542f\u52a8"},"server\u6a21\u5f0f\u542f\u52a8"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ consul agent -server -bootstrap-expect 1 -data-dir /tmp/consul -node=n1 -bind=192.168.6.108 -ui -rejoin -config-dir=/etc/consul.d/ -client 0.0.0.0\n")),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(3654).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u9700\u8981\u5148\u5728/etc/\u4e0b\u9762\u521b\u5efaconsul.d\u76ee\u5f55"),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-server")," \uff1a \u5b9a\u4e49agent\u8fd0\u884c\u5728server\u6a21\u5f0f"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-bootstrap-expect")," \uff1a\u5728\u4e00\u4e2adatacenter\u4e2d\u671f\u671b\u63d0\u4f9b\u7684server\u8282\u70b9\u6570\u76ee\uff0c\u5f53\u8be5\u503c\u63d0\u4f9b\u7684\u65f6\u5019\uff0cconsul\u4e00\u76f4\u7b49\u5230\u8fbe\u5230\u6307\u5b9asever\u6570\u76ee\u7684\u65f6\u5019\u624d\u4f1a\u5f15\u5bfc\u6574\u4e2a\u96c6\u7fa4\uff0c\u8be5\u6807\u8bb0\u4e0d\u80fd\u548cbootstrap\u5171\u7528"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-bind"),"\uff1a\u8be5\u5730\u5740\u7528\u6765\u5728\u96c6\u7fa4\u5185\u90e8\u7684\u901a\u8baf\uff0c\u96c6\u7fa4\u5185\u7684\u6240\u6709\u8282\u70b9\u5230\u5730\u5740\u90fd\u5fc5\u987b\u662f\u53ef\u8fbe\u7684\uff0c\u9ed8\u8ba4\u662f0.0.0.0"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-node"),"\uff1a\u8282\u70b9\u5728\u96c6\u7fa4\u4e2d\u7684\u540d\u79f0\uff0c\u5728\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\uff0c\u9ed8\u8ba4\u662f\u8be5\u8282\u70b9\u7684\u4e3b\u673a\u540d"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-ui"),"\uff1a \u542f\u52a8web\u754c\u9762  :8500"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-rejoin"),"\uff1a\u4f7fconsul\u5ffd\u7565\u5148\u524d\u7684\u79bb\u5f00\uff0c\u5728\u518d\u6b21\u542f\u52a8\u540e\u4ecd\u65e7\u5c1d\u8bd5\u52a0\u5165\u96c6\u7fa4\u4e2d\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-config-dir"),"\uff1a\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u91cc\u9762\u6240\u6709\u4ee5.json\u7ed3\u5c3e\u7684\u6587\u4ef6\u90fd\u4f1a\u88ab\u52a0\u8f7d"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-client"),"\uff1aconsul\u670d\u52a1\u4fa6\u542c\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u63d0\u4f9bHTTP\u3001DNS\u3001RPC\u7b49\u670d\u52a1\uff0c\u9ed8\u8ba4\u662f127.0.0.1\u6240\u4ee5\u4e0d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\uff0c\u5982\u679c\u4f60\u8981\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u6539\u62100.0.0.0"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"data-dir"),"\uff1a\u63d0\u4f9b\u4e00\u4e2a\u76ee\u5f55\u7528\u6765\u5b58\u653eagent\u7684\u72b6\u6001\uff0c\u6240\u6709\u7684agent\u5141\u8bb8\u90fd\u9700\u8981\u8be5\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u5fc5\u987b\u662f\u7a33\u5b9a\u7684\uff0c\u7cfb\u7edf\u91cd\u542f\u540e\u90fd\u7ee7\u7eed\u5b58\u5728"))),(0,a.kt)("h4",{id:"client\u6a21\u5f0f\u542f\u52a8"},(0,a.kt)("strong",{parentName:"h4"},"client\u6a21\u5f0f\u542f\u52a8")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ consul agent -data-dir /tmp/consul -node=n2 -bind=192.168.137.82 -config-dir /etc/consul.d -rejoin -join 192.168.137.81\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8fd0\u884ccosnul agent\u4ee5client\u6a21\u5f0f\uff0c-join \u52a0\u5165\u5230\u5df2\u6709\u7684\u96c6\u7fa4\u4e2d\u53bb\u3002")),(0,a.kt)("h4",{id:"\u67e5\u770bconsul\u6210\u5458"},(0,a.kt)("strong",{parentName:"h4"},"\u67e5\u770bconsul\u6210\u5458")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ consul members\n#\u8282\u70b9  \u7f51\u7edc\u5730\u5740                \u72b6\u6001     \u7c7b\u578b     \u7248\u672c   \u534f\u8bae       \u6570\u636e\u4e2d\u5fc3  \u5206\u7ba1\u90e8\u5206 \nNode  Address                Status  Type    Build  Protocol  DC   Segment\n\nn1    192.168.137.130:8301   alive   server  1.1.0  2         dc1  <all>\nn3    192.168.137.81:8301    alive   client  1.1.0  2         dc1  <default>\n")),(0,a.kt)("h4",{id:"\u505c\u6b62agent"},(0,a.kt)("strong",{parentName:"h4"},"\u505c\u6b62agent")),(0,a.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528Ctrl-C \u4f18\u96c5\u7684\u5173\u95edAgent. \u4e2d\u65adAgent\u4e4b\u540e\u4f60\u53ef\u4ee5\u770b\u5230\u4ed6\u79bb\u5f00\u4e86\u96c6\u7fa4\u5e76\u5173\u95ed."),(0,a.kt)("p",null,"\u200b\t\u5728\u9000\u51fa\u4e2d,Consul\u63d0\u9192\u5176\u4ed6\u96c6\u7fa4\u6210\u5458,\u8fd9\u4e2a\u8282\u70b9\u79bb\u5f00\u4e86.\u5982\u679c\u4f60\u5f3a\u884c\u6740\u6389\u8fdb\u7a0b.\u96c6\u7fa4\u7684\u5176\u4ed6\u6210\u5458\u5e94\u8be5\u80fd\u68c0\u6d4b\u5230\u8fd9\u4e2a\u8282\u70b9\u5931\u6548\u4e86.\u5f53\u4e00\u4e2a\u6210\u5458\u79bb\u5f00,\u4ed6\u7684\u670d\u52a1\u548c\u68c0\u6d4b\u4e5f\u4f1a\u4ece\u76ee\u5f55\u4e2d\u79fb\u9664.\u5f53\u4e00\u4e2a\u6210\u5458\u5931\u6548\u4e86,\u4ed6\u7684\u5065\u5eb7\u72b6\u51b5\u88ab\u7b80\u5355\u7684\u6807\u8bb0\u4e3a\u5371\u9669,\u4f46\u662f\u4e0d\u4f1a\u4ece\u76ee\u5f55\u4e2d\u79fb\u9664.Consul\u4f1a\u81ea\u52a8\u5c1d\u8bd5\u5bf9\u5931\u6548\u7684\u8282\u70b9\u8fdb\u884c\u91cd\u8fde.\u5141\u8bb8\u4ed6\u4ece\u67d0\u4e9b\u7f51\u7edc\u6761\u4ef6\u4e0b\u6062\u590d\u8fc7\u6765.\u79bb\u5f00\u7684\u8282\u70b9\u5219\u4e0d\u4f1a\u518d\u7ee7\u7eed\u8054\u7cfb."),(0,a.kt)("p",null,"\u200b\t\u6b64\u5916,\u5982\u679c\u4e00\u4e2aagent\u4f5c\u4e3a\u4e00\u4e2a\u670d\u52a1\u5668,\u4e00\u4e2a\u4f18\u96c5\u7684\u79bb\u5f00\u662f\u5f88\u91cd\u8981\u7684,\u53ef\u4ee5\u907f\u514d\u5f15\u8d77\u6f5c\u5728\u7684\u53ef\u7528\u6027\u6545\u969c\u5f71\u54cd\u8fbe\u6210\u4e00\u81f4\u6027\u534f\u8bae.\nconsul\u4f18\u96c5\u7684\u9000\u51fa\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ consul leave\n")),(0,a.kt)("h4",{id:"\u6ce8\u518c\u670d\u52a1"},(0,a.kt)("strong",{parentName:"h4"},"\u6ce8\u518c\u670d\u52a1")),(0,a.kt)("p",null,"\u642d\u5efa\u597dconusl\u96c6\u7fa4\u540e\uff0c\u7528\u6237\u6216\u8005\u7a0b\u5e8f\u5c31\u80fd\u5230consul\u4e2d\u53bb\u67e5\u8be2\u6216\u8005\u6ce8\u518c\u670d\u52a1\u3002\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u670d\u52a1\u5b9a\u4e49\u6587\u4ef6\u6216\u8005\u8c03\u7528HTTP API\u6765\u6ce8\u518c\u4e00\u4e2a\u670d\u52a1."),(0,a.kt)("p",null,"\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u5b9a\u4e49\u670d\u52a1\u6587\u4ef6\u6765\u6ce8\u518c\u4e00\u4e2a\u670d\u52a1:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{"service": {\n    "name": "Faceid",\n    "tags": ["rails"],\n    "port": 9000\n    }\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u670d\u52a1\u5b9a\u4e49\u6587\u4ef6\u5728\u6211\u4eec\u7684\u914d\u7f6e\u76ee\u5f55\u4e0b\u9762\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/consul.d/"),"\uff0c\u6587\u4ef6\u90fd\u662f\u4ee5.json\u7ed3\u5c3e\u3002")),(0,a.kt)("p",null,"\u6ce8\u518c\u5b8c\u670d\u52a1\u4e4b\u540e\uff0c\u6211\u4eec\u91cd\u542fconsul\uff0c"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1565103071456",src:t(4803).Z})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u7ea2\u5708\u91cc\u9762\u7684\u5c31\u662f\u8868\u793aagent\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8f7d\u5165\u4e86\u670d\u52a1\u5b9a\u4e49,\u5e76\u4e14\u6210\u529f\u6ce8\u518c\u5230\u670d\u52a1\u76ee\u5f55."),(0,a.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u9700\u8981\u6ce8\u518c\u591a\u4e2a\u670d\u52a1\uff0c\u5c31\u9700\u8981\u521b\u5efa\u591a\u4e2a\u670d\u52a1\u5b9a\u4e49\u6587\u4ef6\u3002")),(0,a.kt)("h4",{id:"\u67e5\u8be2\u670d\u52a1"},(0,a.kt)("strong",{parentName:"h4"},"\u67e5\u8be2\u670d\u52a1")),(0,a.kt)("p",null,"\u4e00\u65e6agent\u542f\u52a8\u5e76\u4e14\u670d\u52a1\u540c\u6b65\u4e86.\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7DNS\u6216\u8005HTTP\u7684API\u6765\u67e5\u8be2\u670d\u52a1.\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7HTTP\u6765\u67e5\u8be2\u670d\u52a1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ curl -s 127.0.0.1:8500/v1/catalog/service/faceid\n")),(0,a.kt)("p",null,"\u5f97\u5230\u4e00\u4e32json\u6570\u636e\uff0c\u4e0d\u8fc7\u683c\u5f0f\u4e0d\u591f\u6e05\u6670\uff0c\u62f7\u8d1d\u5230\u5728\u7ebfjson\u683c\u5f0f\u89e3\u6790\u5668\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1565106650464",src:t(2772).Z})),(0,a.kt)("p",null,"\u6211\u4eec\u8fd8\u53ef\u4ee5\u6253\u5f00web\u9875\u9762\uff0c\u67e5\u770b\u6ce8\u518c\u7684\u670d\u52a1\u3002\u9ed8\u8ba4consul\u5bf9\u5e94\u7684\u7aef\u53e3\u662f8500\uff0c\u5728\u6d4f\u89c8\u5668\u8f93\u5165\u5730\u5740",(0,a.kt)("inlineCode",{parentName:"p"},"localhost:8500")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1565106804694",src:t(2039).Z})),(0,a.kt)("p",null,"\u4e5f\u80fd\u770b\u5230\u6211\u4eec\u6ce8\u518c\u7684\u670d\u52a1\u3002"),(0,a.kt)("h4",{id:"\u5065\u5eb7\u68c0\u67e5"},(0,a.kt)("strong",{parentName:"h4"},"\u5065\u5eb7\u68c0\u67e5")),(0,a.kt)("p",null,"\u5065\u5eb7\u68c0\u67e5\u662f\u670d\u52a1\u53d1\u73b0\u7684\u5173\u952e\u7ec4\u4ef6.\u9884\u9632\u4f7f\u7528\u5230\u4e0d\u5065\u5eb7\u7684\u670d\u52a1.\u548c\u670d\u52a1\u6ce8\u518c\u7c7b\u4f3c,\u4e00\u4e2a\u68c0\u67e5\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u5b9a\u4e49\u6216HTTP API\u8bf7\u6c42\u6765\u6ce8\u518c.\u6211\u4eec\u5c06\u4f7f\u7528\u548c\u68c0\u67e5\u5b9a\u4e49\u6765\u6ce8\u518c\u68c0\u67e5.\u548c\u670d\u52a1\u7c7b\u4f3c,\u56e0\u4e3a\u8fd9\u662f\u5efa\u7acb\u68c0\u67e5\u6700\u5e38\u7528\u7684\u65b9\u5f0f."),(0,a.kt)("p",null,"\u5728/etc/consul.d/\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u6587\u4ef6web2.json,\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{"service": {\n    "name": "web",\n    "tags": ["extract", "verify", "compare", "idcard"],\n    "address": "192.168.137.130",\n    "port": 9000,\n    "check": {\n        "id": "api",\n        "name": "HTTP API on port 9000",\n        "http": "http://localhost:9000",\n        "interval": "10s",\n        "timeout": "1s"\n        }\n   }\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8fd9\u65f6\u5019\u6211\u4eec\u6ca1\u6709\u5f00\u542f\u8fd9\u4e2a\u670d\u52a1\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u5065\u5eb7\u68c0\u67e5\u4f1a\u51fa\u9519\u3002\u6253\u5f00web\u754c\u9762\uff0c\u5982\u4e0b")),(0,a.kt)("p",null,"consul\u505a\u5065\u5eb7\u68c0\u67e5\u7684\u5fc5\u987b\u662f",(0,a.kt)("strong",{parentName:"p"},"Script\u3001HTTP\u3001TCP\u3001TTL"),"\u4e2d\u7684\u4e00\u79cd\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Script\u7c7b\u578b\u9700\u8981\u63d0\u4f9bScript\u811a\u672c\u548cinterval\u53d8\u91cf\u3002"),"\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{  \n  "check": {  \n    "id": "mem-util",  \n    "name": "Memory utilization",  \n    "script": "/usr/local/bin/check_mem.py",  \n    "interval": "10s",  \n    "timeout": "1s"  \n  }  \n} \n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u901a\u8fc7\u6267\u884c\u5916\u90e8\u5e94\u7528\u8fdb\u884c\u5065\u5eb7\u68c0\u67e5\uff1a\u8fd9\u79cd\u5916\u90e8\u7a0b\u5e8f\u5177\u6709\u9000\u51fa\u4ee3\u7801\uff0c\u5e76\u53ef\u80fd\u4ea7\u751f\u4e00\u4e9b\u8f93\u51fa\uff1b\u811a\u672c\u6309\u7167\u6307\u9884\u7f6e\u65f6\u95f4\u95f4\u9694\u6765\u8c03\u7528\uff08\u6bd4\u5982\uff0c\u6bcf30\u79d2\u8c03\u7528\u4e00\u6b21\uff09\uff0c\u7c7b\u4f3c\u4e8eNagios\u63d2\u4ef6\u7cfb\u7edf\uff0c\u811a\u672c\u8f93\u51fa\u9650\u5236\u57284K\u4ee5\u5185\uff0c\u8f93\u51fa\u5927\u4e8e4K\u5c06\u622a\u65ad\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u8d85\u65f6\u65f6\u95f4\u4e3a30\u79d2\u2014\u2014\u53ef\u901a\u8fc7timeout\u6765\u914d\u7f6e\u3002")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"HTTP\u7c7b\u578b\u5fc5\u987b\u63d0\u4f9bhttp\u548cInterval\u5b57\u6bb5\u3002"),"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{  \n  "check": {  \n    "id": "api",  \n    "name": "HTTP API on port 5000",  \n    "http": "http://localhost:5000/health",  \n    "interval": "10s",  \n    "timeout": "1s"  \n  }  \n}  \n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8fd9\u79cd\u68c0\u67e5\u5c06\u6309\u7167\u9884\u8bbe\u7684\u65f6\u95f4\u95f4\u9694\u521b\u5efa\u4e00\u4e2aHTTP \u201cget\u201d\u8bf7\u6c42\u3002HTTP\u54cd\u5e94\u4ee3\u7801\u6765\u6807\u793a\u670d\u52a1\u6240\u5904\u72b6\u6001\uff1a\u4efb\u4f552xx\u4ee3\u7801\u89c6\u4e3a\u6b63\u5e38\uff0c429\u8868\u793a\u8b66\u544a\u2014\u2014\u6709\u5f88\u591a\u8bf7\u6c42\uff1b\u5176\u4ed6\u503c\u8868\u793a\u5931\u8d25\u3002"),(0,a.kt)("p",{parentName:"blockquote"},"\u8fd9\u79cd\u7c7b\u578b\u7684\u68c0\u67e5\u5e94\u4f7f\u7528curl\u6216\u5916\u90e8\u7a0b\u5e8f\u6765\u5904\u7406HTTP\u64cd\u4f5c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cHTTP Checks\u4e2d\uff0c\u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4\u7b49\u4e8e\u8c03\u7528\u8bf7\u6c42\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u6700\u592710\u79d2\u3002\u6709\u53ef\u80fd\u4f7f\u7528\u5ba2\u5236\u7684HTTP check\uff0c\u53ef\u4ee5\u81ea\u7531\u914d\u7f6etimeout\u65f6\u95f4\uff0c\u8f93\u51fa\u9650\u5236\u57284K\u4ee5\u5185\uff0c\u8f93\u51fa\u5927\u4e8e4K\u5c06\u622a\u65ad\u3002")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"TCP\u7c7b\u578b\u9700\u8981\u63d0\u4f9btcp\u548cInterval\u5b57\u6bb5\u3002"),"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{  \n  "check": {  \n    "id": "ssh",  \n    "name": "SSH TCP on port 22",  \n    "tcp": "localhost:22",  \n    "interval": "10s",  \n    "timeout": "1s"  \n  }  \n}  \n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8fd9\u79cd\u68c0\u67e5\u5c06\u6309\u7167\u9884\u8bbe\u7684\u65f6\u95f4\u95f4\u9694\u4e0e\u6307\u5b9a\u7684IP/Hostname\u548c\u7aef\u53e3\u521b\u5efa\u4e00\u4e2aTCP\u8fde\u63a5\u3002\u670d\u52a1\u7684\u72b6\u6001\u4f9d\u8d56\u4e8eTCP\u8fde\u63a5\u662f\u5426\u6210\u529f\u2014\u2014\u5982\u679c\u8fde\u63a5\u6210\u529f\uff0c\u5219\u72b6\u6001\u662f\u201csuccess\u201d\uff1b\u5426\u5219\u72b6\u6001\u662f\u201ccritical\u201d\u3002\u5982\u679c\u4e00\u4e2aHostname\u89e3\u6790\u4e3a\u4e00\u4e2aIPv4\u548c\u4e00\u4e2aIPv6\uff0c\u5c06\u5c1d\u8bd5\u8fde\u63a5\u8fd9\u4e24\u4e2a\u5730\u5740\uff0c\u7b2c\u4e00\u6b21\u8fde\u63a5\u6210\u529f\u5219\u670d\u52a1\u72b6\u6001\u662f\u201csuccess\u201d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cTCP checks\u4e2d\uff0c\u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4\u7b49\u4e8e\u8c03\u7528\u8bf7\u6c42\u7684\u95f4\u9694\u65f6\u95f4\uff0c\u6700\u592710\u79d2\u3002\u4e5f\u662f\u53ef\u4ee5\u81ea\u7531\u914d\u7f6e\u7684\u3002")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"TTL\uff08"),"Timeto Live\u751f\u5b58\u65f6\u95f4",(0,a.kt)("strong",{parentName:"p"},"\uff09\u7c7b\u578b\u53ea\u9700\u63d0\u4f9bttl"),"\uff0c\u5177\u4f53\u914d\u7f6e\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{  \n  "check": {  \n    "id": "web-app",  \n    "name": "Web App Status",  \n    "notes": "Web app does a curl internally every 10 seconds",  \n    "ttl": "30s"  \n  }  \n}  \n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u8fd9\u79cdchecks\u4e3a\u7ed9\u5b9aTTL\u4fdd\u7559\u4e86\u6700\u540e\u4e00\u79cd\u72b6\u6001\uff0cchecks\u7684\u72b6\u6001\u5fc5\u987b\u901a\u8fc7HTTP\u63a5\u53e3\u5468\u671f\u6027\u66f4\u65b0\uff0c\u5982\u679c\u5916\u90e8\u63a5\u53e3\u6ca1\u6709\u66f4\u65b0\u72b6\u6001\uff0c\u90a3\u4e48\u72b6\u6001\u5c31\u4f1a\u88ab\u8ba4\u5b9a\u4e3a\u4e0d\u6b63\u5e38\u3002 TTL checks\u540c\u65f6\u4f1a\u5c06\u5176\u6700\u540e\u5df2\u77e5\u72b6\u6001\u66f4\u65b0\u81f3\u78c1\u76d8\uff0c\u8fd9\u5141\u8bb8Agent\u901a\u8fc7\u91cd\u542f\u540e\u6062\u590d\u5230\u5df2\u77e5\u7684\u72b6\u6001\u3002\u901a\u8fc7TTL\u7aef\u4e0a\u4e00\u6b21check\u6765\u7ef4\u6301\u5065\u5eb7\u72b6\u6001\u7684\u6709\u6548\u6027\u3002")),(0,a.kt)("p",null,"\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u9875\u9762\u6765\u67e5\u770b,\u5728\u6d4f\u89c8\u5668\u8f93\u5165\u7f51\u5740\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://192.68.130.137:8500"},"http://192.68.130.137:8500")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1565107450324",src:t(8495).Z})),(0,a.kt)("p",null,"\u5176\u4ed6\u66f4\u591aconsul\u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u53c2\u8003",(0,a.kt)("a",{parentName:"p",href:"http://www.liangxiansen.cn/2017/04/06/consul/"},"http://www.liangxiansen.cn/2017/04/06/consul/")),(0,a.kt)("h3",{id:"524-consul\u548cgrpc\u7ed3\u5408\u4f7f\u7528"},"5.2.4 consul\u548cgrpc\u7ed3\u5408\u4f7f\u7528"),(0,a.kt)("p",null,"\u5b66\u5b8c\u4e86consul\u547d\u4ee4\u884c\u7684\u4f7f\u7528\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u5728\u4ee3\u7801\u4e2d\u5982\u4f55\u901a\u8fc7\uff0c\u8fd9\u91cc\u6211\u4eec\u7528grpc\u548cconsul\u7ed3\u5408\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u6211\u4eec\u64cd\u4f5cconsul\u4f7f\u7528\u7684\u662fgithub.com/hashicorp/consul/\u5305\uff0c\u6211\u4eec\u5148\u6765\u4e0b\u8f7d\u4e00\u4e0b\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ go get -u -v github.com/hashicorp/consul\n")),(0,a.kt)("p",null,"\u7136\u540e\u6211\u4eec\u5148\u6ce8\u518c\u4e00\u4e2a\u670d\u52a1\u5230consul\u4e0a\uff1a"),(0,a.kt)("h4",{id:"\u628agrpc\u670d\u52a1\u6ce8\u518c\u5230consul\u4e0a"},(0,a.kt)("strong",{parentName:"h4"},"\u628agrpc\u670d\u52a1\u6ce8\u518c\u5230consul\u4e0a")),(0,a.kt)("p",null,"\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u521d\u59cb\u5316consul\u914d\u7f6e\n    consulConfig := api.DefaultConfig()\n\n    //\u83b7\u53d6consul\u64cd\u4f5c\u5bf9\u8c61\n    registry,_ := api.NewClient(consulConfig)\n\n    //\u6ce8\u518c\u670d\u52a1,\u670d\u52a1\u7684\u5e38\u89c4\u914d\u7f6e\n    registerService := api.AgentServiceRegistration{\n        ID:"1",\n        Tags:[]string{"testHello"},\n        Name:"HelloService",\n        Port:8080,\n        Address:"192.168.137.130",\n        Check:&api.AgentServiceCheck{\n            TCP:"192.168.137.130:8080",\n            Timeout:"5s",\n            Interval:"5s",\n        },\n    }\n    //\u6ce8\u518c\u670d\u52a1\u5230consul\u4e0a\n    registry.Agent().ServiceRegister(&registerService)\n    \n    //\u83b7\u53d6grpc\u670d\u52a1\u7aef\u5bf9\u8c61\n    grpcServer := grpc.NewServer()\n    \n    //\u6ce8\u518cgrpc\u670d\u52a1\n    pb.RegisterHelloServiceServer(grpcServer,new(HelloService))\n\n    //\u8bbe\u7f6e\u670d\u52a1\u7aef\u76d1\u542c\n    lis,err := net.Listen("tcp",":1234")\n    if err != nil {\n        panic(err)\n    }\n    //\u5728\u6307\u5b9a\u7aef\u53e3\u4e0a\u63d0\u4f9bgrpc\u670d\u52a1\n    grpcServer.Serve(lis)\n}\n')),(0,a.kt)("h4",{id:"\u670d\u52a1\u53d1\u73b0"},(0,a.kt)("strong",{parentName:"h4"},"\u670d\u52a1\u53d1\u73b0")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n    //\u521d\u59cb\u5316consul\u914d\u7f6e, \u5ba2\u6237\u7aef\u670d\u52a1\u5668\u9700\u8981\u4e00\u81f4\n    consulConfig := api.DefaultConfig()\n    \n    //\u83b7\u53d6consul\u64cd\u4f5c\u5bf9\u8c61\n    registerClient,_ := api.NewClient(consulConfig)\n\n    //\u83b7\u53d6\u5730\u5740\n    serviceEntry,_,_ :=registerClient.Health().Service("HelloService","testHello",false,&api.QueryOptions{})\n\n    //\u548cgrpc\u670d\u52a1\u5efa\u7acb\u8fde\u63a5\n    conn,err := grpc.Dial(serviceEntry[0].Service.Address+":"+strconv.Itoa(serviceEntry[0].Service.Port),grpc.WithInsecure())\n    if err != nil {\n        panic(err)\n    }\n\n    defer conn.Close()\n\n    client := pb.NewHelloServiceClient(conn)\n    reply, err := client.Hello(context.Background(),&pb.Person{Name:"lisi",Age:100})\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println("reply,",reply)\n}\n')),(0,a.kt)("h4",{id:"\u6ce8\u9500\u670d\u52a1"},(0,a.kt)("strong",{parentName:"h4"},"\u6ce8\u9500\u670d\u52a1")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'func main(){\n     //\u521d\u59cb\u5316consul\u914d\u7f6e,\u5ba2\u6237\u7aef\u670d\u52a1\u5668\u9700\u8981\u4e00\u81f4\n    consulConfig := api.DefaultConfig()\n    \n    //\u83b7\u53d6consul\u64cd\u4f5c\u5bf9\u8c61\n    registerClient,_ := api.NewClient(consulConfig)\n\n\n    //\u6ce8\u9500\u670d\u52a1\n     client.Agent().ServiceDeregister("1")\n}\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"etcd\u3001  zookeeper")),(0,a.kt)("h2",{id:"53-go-micro\u5b89\u88c5"},"5.3 go-micro\u5b89\u88c5"),(0,a.kt)("p",null,"\u505a\u4e86\u8fd9\u4e48\u4e45\u7684\u94fa\u57ab\uff0c\u63a5\u7740\u8ba9\u6211\u4eec\u6765\u8fdb\u5165\u4e3b\u9898\uff0cgo-micro\u7684\u5b66\u4e60\uff0c\u9996\u5148\u6211\u4eec\u5148\u6765\u5b89\u88c5\u4e00\u4e0bgo-micro\u5f00\u53d1\u73af\u5883\u3002\u5b89\u88c5\u6b65\u9aa4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"#\u5b89\u88c5go-micro\ngo get -u -v github.com/micro/go-micro\n#\u5b89\u88c5\u5de5\u5177\u96c6\ngo get -u -v github.com/micro/micro\n#\u5b89\u88c5protobuf\u63d2\u4ef6\ngo get -u github.com/golang/protobuf/{proto,protoc-gen-go}\ngo get -u github.com/micro/protoc-gen-micro\n")),(0,a.kt)("p",null,"\u6216\u8005\u901a\u8fc7docker\u955c\u50cf\u5b89\u88c5\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"$ docker pull microhq/micro\n")),(0,a.kt)("p",null,"\u5b89\u88c5\u4e4b\u540e\u8f93\u5165micro\u547d\u4ee4\uff0c\u663e\u793a\u5982\u4e0b\u5c31\u8bc1\u660e\u5b89\u88c5\u6210\u529f"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"1565108115509",src:t(2714).Z})),(0,a.kt)("p",null,"\u63a5\u7740\u6211\u4eec\u6765\u770b\u4e00\u4e0bgo-micro\u7684\u4f7f\u7528\u3002"),(0,a.kt)("h2",{id:"54-go-micro\u4f7f\u7528"},"5.4 go-micro\u4f7f\u7528"),(0,a.kt)("p",null,"\u9996\u5148\u6211\u4eec\u5148\u6765\u521b\u5efa\u4e00\u4e2ago micro\u6846\u67b6\u7684\u9879\u76ee\uff0c\u6211\u4eec\u4f7f\u7528micro\u547d\u4ee4\uff0c\u53ef\u4ee5\u521b\u5efa\u5fae\u670d\u52a1\uff0cweb\u9879\u76ee\u7b49\uff0c\u5177\u4f53\u7528\u6cd5\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'new     Create a new Micro service by specifying a directory path relative to your $GOPATH\n#\u521b\u5efa \u901a\u8fc7\u6307\u5b9a\u76f8\u5bf9\u4e8e$GOPATH\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5fae\u670d\u52a1\u3002\n\nUSAGE:\n#\u7528\u6cd5\nmicro new [command options][arguments...]\n#\u6307\u5b9a\u670d\u52a1\u7684\u547d\u540d\u7a7a\u95f4\n--namespace "go.micro"  Namespace for the service e.g com.example\n#\u670d\u52a1\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u5fae\u670d\u52a1srv,\u6216\u8005web\u9879\u76ee,\u6216\u8005api\u7b49                      \n--type "srv"            Type of service e.g api, fnc, srv, web\n#\u670d\u52a1\u7684\u6b63\u5f0f\u5b8c\u6574\u5b9a\u4e49                      \n--fqdn                  FQDN of service e.g com.example.srv.service (defaults to namespace.type.alias)\n#\u522b\u540d\u662f\u5728\u6307\u5b9a\u65f6\u4f5c\u4e3a\u7ec4\u5408\u540d\u7684\u4e00\u90e8\u5206\u4f7f\u7528\u7684\u77ed\u540d\u79f0  \u522b\u540d                     \n--alias                 Alias is the short name used as part of combined name if specified\n\n')),(0,a.kt)("p",null,"\u6211\u4eec\u5e38\u7528\u7684\u5c31\u662f\u521b\u5efa\u5fae\u670d\u52a1\u548cweb\u9879\u76ee\uff0c\u5982\u4e0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u521b\u5efa\u4e00\u4e2aweb\u9879\u76ee")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'micro new --type "web" micro/rpc/web\nCreating service go.micro.web.web in /home/itcast/go/src/micro/rpc/web\n.\n#\u4e3b\u51fd\u6570\n\u251c\u2500\u2500 main.go \n#\u63d2\u4ef6\u6587\u4ef6\n\u251c\u2500\u2500 plugin.go\n#\u88ab\u8c03\u7528\u5904\u7406\u51fd\u6570\n\u251c\u2500\u2500 handler\n\u2502\xa0\xa0 \u2514\u2500\u2500 handler.go\n#\u524d\u7aef\u9875\u9762\n\u251c\u2500\u2500 html\n\u2502\xa0\xa0 \u2514\u2500\u2500 index.html\n#docker\u751f\u6210\u6587\u4ef6\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 README.md\n\n#\u7f16\u8bd1\u540e\u5c06web\u7aef\u547c\u53ebsrv\u7aef\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5185\u5bb9\u4fee\u6539\u4e3asrv\u7684\u5185\u5bb9\n#\u9700\u8981\u8fdb\u884c\u8c03\u901a\n')),(0,a.kt)("p",null,"\u6253\u5f00\u6211\u4eecweb\u9879\u76ee\u4e0b\u7684main.go\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "github.com/micro/go-log"\n    "net/http"\n    "github.com/micro/go-web"\n    "micro/rpc/web/handler"\n)\n\nfunc main() {\n    // \u521b\u5efa1\u4e2aweb\u670d\u52a1\n        service := web.NewService(\n           //\u6ce8\u518c\u670d\u52a1\u540d\n                web.Name("go.micro.web.web"),\n            //\u670d\u52a1\u7684\u7248\u672c\u53f7\n                web.Version("latest"),\n                //\uff01\u6dfb\u52a0\u7aef\u53e3\n                web.Address(":8080"),\n        )\n\n    //\u670d\u52a1\u8fdb\u884c\u521d\u59cb\u5316\n        if err := service.Init(); err != nil {\n                log.Fatal(err)\n        }\n\n    //\u5904\u7406\u8bf7\u6c42  / \u7684\u8def\u7531   //\u5f53\u524d\u8fd9\u4e2aweb\u5fae\u670d\u52a1\u7684 html\u6587\u4ef6\u8fdb\u884c\u6620\u5c04\n    service.Handle("/", http.FileServer(http.Dir("html")))\n\n    //\u5904\u7406\u8bf7\u6c42 /example/call  \u7684\u8def\u7531   \u8fd9\u4e2a\u76f8\u5e94\u51fd\u6570 \u5728\u5f53\u524d\u9879\u76ee\u4e0b\u7684handler\n    service.HandleFunc("/example/call", handler.ExampleCall)\n\n    //\u8fd0\u884c\u670d\u52a1\n        if err := service.Run(); err != nil {\n                log.Fatal(err)\n        }\n}\n')),(0,a.kt)("p",null,"\u63a5\u7740\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e0b\u6211\u4eec\u91cd\u70b9\u9700\u8981\u64cd\u4f5c\u7684\u6587\u4ef6\uff0chandle.go,\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package handler\n\nimport (\n    "context"\n    "encoding/json"\n    "net/http"\n    "time"\n\n    "github.com/micro/go-micro/client"\n    //\u5c06srv\u4e2d\u7684proto\u7684\u6587\u4ef6\u5bfc\u5165\u8fdb\u6765\u8fdb\u884c\u901a\u4fe1\u7684\u4f7f\u7528\n    example "micro/rpc/srv/proto/example"\n)\n//\u76f8\u5e94\u8bf7\u6c42\u7684\u4e1a\u52a1\u51fd\u6570\nfunc ExampleCall(w http.ResponseWriter, r *http.Request) {\n    // \u5c06\u4f20\u5165\u7684\u8bf7\u6c42\u89e3\u7801\u4e3ajson\n    var request map[string]interface{}\n    if err := json.NewDecoder(r.Body).Decode(&request); err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    // \u8c03\u7528\u670d\u52a1\n    //\u66ff\u6362\u6389\u539f\u6709\u7684\u670d\u52a1\u540d\n    //\u901a\u8fc7\u670d\u52a1\u540d\u548c\n    exampleClient := example.NewExampleService("go.micro.srv.srv", client.DefaultClient)\n    rsp, err := exampleClient.Call(context.TODO(), &example.Request{\n        Name: request["name"].(string),\n    })\n    if err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n\n    // we want to augment the response\n    response := map[string]interface{}{\n        "msg": rsp.Msg,\n        "ref": time.Now().UnixNano(),\n    }\n\n    // encode and write the response as json\n    if err := json.NewEncoder(w).Encode(response); err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n}\n\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u521b\u5efa\u5fae\u670d\u52a1")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$micro new --type "srv" t1/t1\n#"srv" \u662f\u8868\u793a\u5f53\u524d\u521b\u5efa\u7684\u5fae\u670d\u52a1\u7c7b\u578b\n#micro\u662f\u76f8\u5bf9\u4e8ego/src\u4e0b\u7684\u6587\u4ef6\u5939\u540d\u79f0 \u53ef\u4ee5\u6839\u636e\u9879\u76ee\u8fdb\u884c\u8bbe\u7f6e \n#srv\u662f\u5f53\u524d\u521b\u5efa\u7684\u5fae\u670d\u52a1\u7684\u6587\u4ef6\u540d\nCreating service go.micro.srv.srv in /home/itcast/go/src/t1/t1\n\n.\n#\u4e3b\u51fd\u6570\u5b58\u653e\u4f4d\u7f6e\n\u251c\u2500\u2500 main.go\n#\u63d2\u4ef6\n\u251c\u2500\u2500 plugin.go\n#\u670d\u52a1\u63d0\u4f9b\u51fd\u6570\u7684\u5b9e\u73b0\n\u251c\u2500\u2500 handler\n\u2502\xa0\xa0 \u2514\u2500\u2500 example.go\n#\u8ba2\u9605\u670d\u52a1\n\u251c\u2500\u2500 subscriber\n\u2502\xa0\xa0 \u2514\u2500\u2500 example.go\n#proto\u534f\u8bae\n\u251c\u2500\u2500 proto/example\n\u2502\xa0\xa0 \u2514\u2500\u2500 example.proto\n#docker\u751f\u6210\u6587\u4ef6\n\u251c\u2500\u2500 Dockerfile\n#\u7f16\u8bd1\u6587\u4ef6\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 README.md\n\n#\u63d2\u4ef6\u63d0\u793a\uff0c\u5df2\u5b89\u88c5\uff0c\u53ef\u5ffd\u7565\ndownload protobuf for micro:\n\nbrew install protobuf\ngo get -u github.com/golang/protobuf/{proto,protoc-gen-go}\ngo get -u github.com/micro/protoc-gen-micro\n\ncompile the proto file example.proto:\n\ncd /home/itcast/go/src/micro/rpc/srv\nprotoc --proto_path=. --go_out=. --micro_out=. proto/example/example.proto\n')),(0,a.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5fae\u670d\u52a1\u4e2d\u7684main.go\u6587\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n        "github.com/micro/go-micro/util/log"\n        "github.com/micro/go-micro"\n        "t1/t1/handler"\n        "t1/t1/subscriber"\n\n        t1 "t1/t1/proto/t1"\n)\n\nfunc main() {\n        // \u521b\u5efa\u4e00\u4e2amicro\u670d\u52a1\n        service := micro.NewService(\n                micro.Name("go.micro.srv.t1"),\n                micro.Version("latest"),\n        )\n\n        // \u521d\u59cb\u5316\u670d\u52a1\n        service.Init()\n\n        // \u6ce8\u518c\u670d\u52a1\n        t1.RegisterT1Handler(service.Server(), new(handler.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), new(subscriber.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u51fd\u6570\u5230\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), subscriber.Handler)\n\n        // \u8fd0\u884c\u670d\u52a1\n        if err := service.Run(); err != nil {\n                log.Fatal(err)\n        }\n}\n')),(0,a.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgo micro\u6846\u67b6\u4f7f\u7528\u7684\u662f\u81ea\u5df1\u5c01\u88c5\u7684rpc\u901a\u4fe1\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u66ff\u6362\u6210grpc\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n        "github.com/micro/go-micro/util/log"\n        "github.com/micro/go-micro"\n        "t1/t1/handler"\n        "t1/t1/subscriber"\n        "github.com/micro/go-grpc"//go micro\u5185\u5d4c\u4e86grpc\u6846\u67b6\n        t1 "t1/t1/proto/t1"\n)\n\nfunc main() {\n        // \u521b\u5efa\u4e00\u4e2amicro\u670d\u52a1\n        service := grpc.NewService(\n                micro.Name("go.micro.srv.t1"),\n                micro.Version("latest"),\n        )\n\n        // \u521d\u59cb\u5316\u670d\u52a1\n        service.Init()\n\n        // \u6ce8\u518c\u670d\u52a1\n        t1.RegisterT1Handler(service.Server(), new(handler.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), new(subscriber.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u51fd\u6570\u5230\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), subscriber.Handler)\n\n        // \u8fd0\u884c\u670d\u52a1\n        if err := service.Run(); err != nil {\n                log.Fatal(err)\n        }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u670d\u52a1\u53d1\u73b0\uff1a")),(0,a.kt)("p",null,"\u5728go-micro\u5305\u4e2d\uff0c\u5171\u67094\u79cd\u6ce8\u518c\u5b9e\u73b0consul\u3001gossip\u3001mdns\u3001memory\uff0c\u524d\u4e24\u4e2a\u90fd\u662f\u57fa\u4e8ehashicorp\u516c\u53f8\u7684\u534f\u8bae\uff0cmdns\u5219\u662f\u57fa\u4e8e\u7ec4\u7f51\u5e7f\u64ad\u5b9e\u73b0\uff0cmemory\u5219\u662f\u672c\u5730\u5b9e\u73b0\u3002"),(0,a.kt)("p",null,"consul \u4f9d\u8d56hashicorp\u7684\u7ec4\u4ef6\uff0c\u4f46\u662f\u529f\u80fd\u5f3a\u5927\u3001\u5b8c\u6574\ngossip \u57fa\u4e8eSWIM\u534f\u8bae\u5e7f\u64ad\uff0c\u96f6\u4f9d\u8d56\nmdns \u8f7b\u91cf\u3001\u96f6\u4f9d\u8d56\uff0c\u4f46\u662f\u5bf9\u73af\u5883\u6709\u8981\u6c42\uff0c\u67d0\u4e9b\u73af\u5883\u4e0d\u652f\u6301mdns\u7684\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528\nmemory \u672c\u5730\u89e3\u51b3\u65b9\u6848\uff0c\u4e0d\u53ef\u8de8\u4e3b\u673a\u8bbf\u95ee\n\u53e6\u5916\u5728go-plugins\u4e2d\u6709\u5176\u5b83\u6ce8\u518c\u5b9e\u73b0\uff0c\u6bd4\u5982etcd\u3001eureka\u3001k8s\u3001nats\u3001zk\u7b49\u7b49"),(0,a.kt)("p",null,"\u5927\u4f53\u89e3\u91ca\u4e0b\u63a5\u53e3\u4e2d\u6bcf\u4e2a\u65b9\u6cd5\u7684\u4f5c\u7528"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Init \u521d\u59cb\u5316"),(0,a.kt)("li",{parentName:"ul"},"Options \u83b7\u53d6\u914d\u7f6e\u9009\u9879"),(0,a.kt)("li",{parentName:"ul"},"Register \u6ce8\u518c\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"Deregister \u5378\u8f7d\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"GetService \u83b7\u53d6\u6307\u5b9a\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"ListServices \u5217\u51fa\u6240\u6709\u670d\u52a1"),(0,a.kt)("li",{parentName:"ul"},"Watch watcher \u8d1f\u8d23\u4fa6\u542c\u53d8\u52a8"),(0,a.kt)("li",{parentName:"ul"},"String \u6ce8\u518c\u4fe1\u606f\u8f6c\u6210\u5b57\u7b26\u4e32\u63cf\u8ff0")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n        "github.com/micro/go-micro/util/log"\n        "github.com/micro/go-micro"\n        "t1/t1/handler"\n        "t1/t1/subscriber"\n        "github.com/micro/go-grpc"\n        "github.com/micro/go-micro/registry/consul"\n        "github.com/micro/go-micro/registry"\n        t1 "t1/t1/proto/t1"\n)\n\nfunc main() {\n        //\u521d\u59cb\u5316\u670d\u52a1\u53d1\u73b0\n        reg := consul.NewRegistry(func(options *registry.Options) {\n                options.Addrs = []string{\n                        "192.168.137.130:8500",\n                }\n        })\n\n    \n        // \u521b\u5efa\u4e00\u4e2amicro\u670d\u52a1\n        service := grpc.NewService(\n                micro.Name("go.micro.srv.t1"),\n                micro.Version("latest"),\n                micro.Registry(reg),\n        )\n\n        // \u521d\u59cb\u5316\u670d\u52a1\n        service.Init()\n\n        // \u6ce8\u518c\u670d\u52a1\n        t1.RegisterT1Handler(service.Server(), new(handler.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), new(subscriber.T1))\n\n        // \u6ce8\u518c\u4e00\u4e2a\u51fd\u6570\u5230\u53d1\u5e03\u5668\n        micro.RegisterSubscriber("go.micro.srv.t1", service.Server(), subscriber.Handler)\n\n        // \u8fd0\u884c\u670d\u52a1\n        if err := service.Run(); err != nil {\n                log.Fatal(err)\n        }\n}\n')),(0,a.kt)("h2",{id:""}))}g.isMDXComponent=!0},7404:function(e,n,t){n.Z=t.p+"assets/images/1538379054131-6da44f6d5c7fa42bd3d2fa34baf6d5c8.png"},6739:function(e,n,t){n.Z=t.p+"assets/images/1538379597103-41be65b963a8f8dd510e13001544810e.png"},3606:function(e,n,t){n.Z=t.p+"assets/images/1538380442745-6f33afa6a349ed29db1b946111c8a92a.png"},3654:function(e,n,t){n.Z=t.p+"assets/images/1561950926758-b036b16be284156e57db9ccbee62924b.png"},448:function(e,n,t){n.Z=t.p+"assets/images/1563802988667-319db97fdc99cb5275bad0d350ffb8b6.png"},4447:function(e,n,t){n.Z=t.p+"assets/images/1564056754698-52350fa4581c374c12908ccf0c47a0f2.png"},2773:function(e,n,t){n.Z=t.p+"assets/images/1564058423216-421c13a99173564986388fab7ce4c456.png"},9717:function(e,n,t){n.Z=t.p+"assets/images/1564061722380-b54ece9a3a2c0a9f08f10ad37f554e10.png"},2246:function(e,n,t){n.Z=t.p+"assets/images/1564372623923-aee7d50ba84faf83e934ad6b2cb1d4a5.png"},6281:function(e,n,t){n.Z=t.p+"assets/images/1564373553013-91f1946c18c3296794fe146b9bdab9ee.png"},6882:function(e,n,t){n.Z=t.p+"assets/images/1564396573015-ab8698f32ae031e21d4fd1dab5eb0cb8.png"},3957:function(e,n,t){n.Z=t.p+"assets/images/1564539159120-84abcb8c926a14ed75c0489d3cb295d8.png"},3545:function(e,n,t){n.Z=t.p+"assets/images/1564628074411-6d8a5c107c3095616e30e3e19bcaabd2.png"},6155:function(e,n,t){n.Z=t.p+"assets/images/1564652925915-60ddc48cb1de85eb733b7084f07d7b5f.png"},4803:function(e,n,t){n.Z=t.p+"assets/images/1565103071456-b2a1373f55d65c52a358f26755a1e9f6.png"},2772:function(e,n,t){n.Z=t.p+"assets/images/1565106650464-f54f32d4ea733be13e7a4ccde5e5732a.png"},2039:function(e,n,t){n.Z=t.p+"assets/images/1565106804694-575c2a95721d2be582e5a6c69d35d1d7.png"},8495:function(e,n,t){n.Z=t.p+"assets/images/1565107450324-10a19be2742c5679cad28ceed80d0b7a.png"},2714:function(e,n,t){n.Z=t.p+"assets/images/1565108115509-a23555b2f697732c2d08399169a729df.png"}}]);